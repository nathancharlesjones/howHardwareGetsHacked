ARM GAS  /tmp/cc3QQpu6.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"fobFirmware.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.rodata.pairFob.str1.4,"aMS",%progbits,1
  18              		.align	2
  19              	.LC0:
  20 0000 5000     		.ascii	"P\000"
  21 0002 0000     		.align	2
  22              	.LC1:
  23 0004 50616972 		.ascii	"Paired\000"
  23      656400
  24              		.section	.text.pairFob,"ax",%progbits
  25              		.align	1
  26              		.global	pairFob
  27              		.arch armv7e-m
  28              		.syntax unified
  29              		.thumb
  30              		.thumb_func
  31              		.fpu fpv4-sp-d16
  33              	pairFob:
  34              	.LVL0:
  35              	.LFB1:
  36              		.file 1 "../../application/src/fobFirmware.c"
   1:../../application/src/fobFirmware.c **** /**
   2:../../application/src/fobFirmware.c ****  * @file main.c
   3:../../application/src/fobFirmware.c ****  * @author Frederich Stine
   4:../../application/src/fobFirmware.c ****  * @brief eCTF Fob Example Design Implementation
   5:../../application/src/fobFirmware.c ****  * @date 2023
   6:../../application/src/fobFirmware.c ****  *
   7:../../application/src/fobFirmware.c ****  * This source file is part of an example system for MITRE's 2023 Embedded
   8:../../application/src/fobFirmware.c ****  * System CTF (eCTF). This code is being provided only for educational purposes
   9:../../application/src/fobFirmware.c ****  * for the 2023 MITRE eCTF competition, and may not meet MITRE standards for
  10:../../application/src/fobFirmware.c ****  * quality. Use this code at your own risk!
  11:../../application/src/fobFirmware.c ****  *
  12:../../application/src/fobFirmware.c ****  * @copyright Copyright (c) 2023 The MITRE Corporation
  13:../../application/src/fobFirmware.c ****  */
  14:../../application/src/fobFirmware.c **** 
  15:../../application/src/fobFirmware.c **** #include <stdbool.h>
  16:../../application/src/fobFirmware.c **** #include <stdint.h>
  17:../../application/src/fobFirmware.c **** #include <string.h>
  18:../../application/src/fobFirmware.c **** 
  19:../../application/src/fobFirmware.c **** #include "secrets.h"
  20:../../application/src/fobFirmware.c **** #include "messages.h"
  21:../../application/src/fobFirmware.c **** #include "dataFormats.h"
ARM GAS  /tmp/cc3QQpu6.s 			page 2


  22:../../application/src/fobFirmware.c **** #include "uart.h"
  23:../../application/src/fobFirmware.c **** #include "platform.h"
  24:../../application/src/fobFirmware.c **** 
  25:../../application/src/fobFirmware.c **** /*** Structure definitions ***/
  26:../../application/src/fobFirmware.c **** // Defines a struct for the format of an enable message
  27:../../application/src/fobFirmware.c **** typedef struct
  28:../../application/src/fobFirmware.c **** {
  29:../../application/src/fobFirmware.c ****   uint8_t car_id[8];
  30:../../application/src/fobFirmware.c ****   uint8_t feature;
  31:../../application/src/fobFirmware.c **** } ENABLE_PACKET;
  32:../../application/src/fobFirmware.c **** 
  33:../../application/src/fobFirmware.c **** /*** Function definitions ***/
  34:../../application/src/fobFirmware.c **** // Core functions - all functionality supported by fob
  35:../../application/src/fobFirmware.c **** void pairFob(FLASH_DATA *fob_state_ram);
  36:../../application/src/fobFirmware.c **** void unlockCar(FLASH_DATA *fob_state_ram);
  37:../../application/src/fobFirmware.c **** void enableFeature(FLASH_DATA *fob_state_ram);
  38:../../application/src/fobFirmware.c **** void startCar(FLASH_DATA *fob_state_ram);
  39:../../application/src/fobFirmware.c **** 
  40:../../application/src/fobFirmware.c **** // Helper functions - receive ack message
  41:../../application/src/fobFirmware.c **** uint8_t receiveAck();
  42:../../application/src/fobFirmware.c **** 
  43:../../application/src/fobFirmware.c **** /**
  44:../../application/src/fobFirmware.c ****  * @brief Main function for the fob example
  45:../../application/src/fobFirmware.c ****  *
  46:../../application/src/fobFirmware.c ****  * Listens over UART and SW1 for an unlock command. If unlock command presented,
  47:../../application/src/fobFirmware.c ****  * attempts to unlock door. Listens over UART for pair command. If pair
  48:../../application/src/fobFirmware.c ****  * command presented, attempts to either pair a new key, or be paired
  49:../../application/src/fobFirmware.c ****  * based on firmware build.
  50:../../application/src/fobFirmware.c ****  */
  51:../../application/src/fobFirmware.c **** int main(int argc, char ** argv)
  52:../../application/src/fobFirmware.c **** {
  53:../../application/src/fobFirmware.c ****   initHardware_fob(argc, argv);
  54:../../application/src/fobFirmware.c **** 
  55:../../application/src/fobFirmware.c ****   FLASH_DATA fob_state_ram;
  56:../../application/src/fobFirmware.c ****   //FLASH_DATA fob_state_flash;
  57:../../application/src/fobFirmware.c ****   //readVar((uint8_t*)(&fob_state_flash), "fob_state");
  58:../../application/src/fobFirmware.c ****   readVar((uint8_t*)(&fob_state_ram), "fob_state");
  59:../../application/src/fobFirmware.c **** 
  60:../../application/src/fobFirmware.c **** // If paired fob, initialize the system information
  61:../../application/src/fobFirmware.c **** #if PAIRED == 1
  62:../../application/src/fobFirmware.c ****   //if (fob_state_flash.paired == FLASH_UNPAIRED)
  63:../../application/src/fobFirmware.c ****   if (fob_state_ram.paired == FLASH_UNPAIRED)
  64:../../application/src/fobFirmware.c ****   {
  65:../../application/src/fobFirmware.c ****     strcpy((char *)(fob_state_ram.pair_info.password), PASSWORD);
  66:../../application/src/fobFirmware.c ****     strcpy((char *)(fob_state_ram.pair_info.pin), PAIR_PIN);
  67:../../application/src/fobFirmware.c ****     strcpy((char *)(fob_state_ram.pair_info.car_id), CAR_ID);
  68:../../application/src/fobFirmware.c ****     strcpy((char *)(fob_state_ram.feature_info.car_id), CAR_ID);
  69:../../application/src/fobFirmware.c ****     fob_state_ram.paired = FLASH_PAIRED;
  70:../../application/src/fobFirmware.c **** 
  71:../../application/src/fobFirmware.c ****     saveFobState(&fob_state_ram);
  72:../../application/src/fobFirmware.c ****   }
  73:../../application/src/fobFirmware.c **** #else
  74:../../application/src/fobFirmware.c ****   fob_state_ram.paired = FLASH_UNPAIRED;
  75:../../application/src/fobFirmware.c **** #endif
  76:../../application/src/fobFirmware.c **** 
  77:../../application/src/fobFirmware.c ****   /*
  78:../../application/src/fobFirmware.c ****   if (fob_state_flash.paired == FLASH_PAIRED)
ARM GAS  /tmp/cc3QQpu6.s 			page 3


  79:../../application/src/fobFirmware.c ****   {
  80:../../application/src/fobFirmware.c ****     memcpy(&fob_state_ram, &fob_state_flash, sizeof(FLASH_DATA));
  81:../../application/src/fobFirmware.c ****   }
  82:../../application/src/fobFirmware.c ****   */
  83:../../application/src/fobFirmware.c **** 
  84:../../application/src/fobFirmware.c ****   // This will run on first boot to initialize features
  85:../../application/src/fobFirmware.c ****   if (fob_state_ram.feature_info.num_active == 0xFF)
  86:../../application/src/fobFirmware.c ****   {
  87:../../application/src/fobFirmware.c ****     fob_state_ram.feature_info.num_active = 0;
  88:../../application/src/fobFirmware.c ****     saveFobState(&fob_state_ram);
  89:../../application/src/fobFirmware.c ****   }
  90:../../application/src/fobFirmware.c **** 
  91:../../application/src/fobFirmware.c ****   // Declare a buffer for reading and writing to UART
  92:../../application/src/fobFirmware.c ****   uint8_t uart_buffer[10];
  93:../../application/src/fobFirmware.c ****   uint8_t uart_buffer_index = 0;
  94:../../application/src/fobFirmware.c **** 
  95:../../application/src/fobFirmware.c ****   // Infinite loop for polling UART
  96:../../application/src/fobFirmware.c ****   while (true)
  97:../../application/src/fobFirmware.c ****   {
  98:../../application/src/fobFirmware.c **** 
  99:../../application/src/fobFirmware.c ****     // Non blocking UART polling
 100:../../application/src/fobFirmware.c ****     if (uart_avail(HOST_UART))
 101:../../application/src/fobFirmware.c ****     {
 102:../../application/src/fobFirmware.c ****       uint8_t uart_char = (uint8_t)uart_readb(HOST_UART);
 103:../../application/src/fobFirmware.c **** 
 104:../../application/src/fobFirmware.c ****       if ((uart_char != '\r') && (uart_char != '\n') && (uart_char != '\0') &&
 105:../../application/src/fobFirmware.c ****           (uart_char != 0xD))
 106:../../application/src/fobFirmware.c ****       {
 107:../../application/src/fobFirmware.c ****         uart_buffer[uart_buffer_index] = uart_char;
 108:../../application/src/fobFirmware.c ****         uart_buffer_index++;
 109:../../application/src/fobFirmware.c ****       }
 110:../../application/src/fobFirmware.c ****       else
 111:../../application/src/fobFirmware.c ****       {
 112:../../application/src/fobFirmware.c ****         uart_buffer[uart_buffer_index] = 0x00;
 113:../../application/src/fobFirmware.c ****         uart_buffer_index = 0;
 114:../../application/src/fobFirmware.c **** 
 115:../../application/src/fobFirmware.c ****         if (!(strcmp((char *)uart_buffer, "enable")))
 116:../../application/src/fobFirmware.c ****         {
 117:../../application/src/fobFirmware.c ****           enableFeature(&fob_state_ram);
 118:../../application/src/fobFirmware.c ****         }
 119:../../application/src/fobFirmware.c ****         else if (!(strcmp((char *)uart_buffer, "pair")))
 120:../../application/src/fobFirmware.c ****         {
 121:../../application/src/fobFirmware.c ****           pairFob(&fob_state_ram);
 122:../../application/src/fobFirmware.c ****         }
 123:../../application/src/fobFirmware.c ****       }
 124:../../application/src/fobFirmware.c ****     }
 125:../../application/src/fobFirmware.c **** 
 126:../../application/src/fobFirmware.c ****     if(buttonPressed())
 127:../../application/src/fobFirmware.c ****     {
 128:../../application/src/fobFirmware.c ****       unlockCar(&fob_state_ram);
 129:../../application/src/fobFirmware.c ****       if (receiveAck())
 130:../../application/src/fobFirmware.c ****       {
 131:../../application/src/fobFirmware.c ****         startCar(&fob_state_ram);
 132:../../application/src/fobFirmware.c ****       }
 133:../../application/src/fobFirmware.c ****     }
 134:../../application/src/fobFirmware.c ****   }
 135:../../application/src/fobFirmware.c **** }
ARM GAS  /tmp/cc3QQpu6.s 			page 4


 136:../../application/src/fobFirmware.c **** 
 137:../../application/src/fobFirmware.c **** /**
 138:../../application/src/fobFirmware.c ****  * @brief Function that carries out pairing of the fob
 139:../../application/src/fobFirmware.c ****  *
 140:../../application/src/fobFirmware.c ****  * @param fob_state_ram pointer to the current fob state in ram
 141:../../application/src/fobFirmware.c ****  */
 142:../../application/src/fobFirmware.c **** void pairFob(FLASH_DATA *fob_state_ram)
 143:../../application/src/fobFirmware.c **** {
  37              		.loc 1 143 1 view -0
  38              		.cfi_startproc
  39              		@ args = 0, pretend = 0, frame = 16
  40              		@ frame_needed = 0, uses_anonymous_args = 0
  41              		.loc 1 143 1 is_stmt 0 view .LVU1
  42 0000 70B5     		push	{r4, r5, r6, lr}
  43              	.LCFI0:
  44              		.cfi_def_cfa_offset 16
  45              		.cfi_offset 4, -16
  46              		.cfi_offset 5, -12
  47              		.cfi_offset 6, -8
  48              		.cfi_offset 14, -4
  49 0002 84B0     		sub	sp, sp, #16
  50              	.LCFI1:
  51              		.cfi_def_cfa_offset 32
  52 0004 0446     		mov	r4, r0
 144:../../application/src/fobFirmware.c ****   MESSAGE_PACKET message;
  53              		.loc 1 144 3 is_stmt 1 view .LVU2
 145:../../application/src/fobFirmware.c ****   // Start pairing transaction - fob is already paired
 146:../../application/src/fobFirmware.c ****   if (fob_state_ram->paired == FLASH_PAIRED)
  54              		.loc 1 146 3 view .LVU3
  55              		.loc 1 146 20 is_stmt 0 view .LVU4
  56 0006 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
  57              		.loc 1 146 6 view .LVU5
  58 0008 EBB9     		cbnz	r3, .L2
  59              	.LBB2:
 147:../../application/src/fobFirmware.c ****   {
 148:../../application/src/fobFirmware.c ****     int16_t bytes_read;
  60              		.loc 1 148 5 is_stmt 1 view .LVU6
 149:../../application/src/fobFirmware.c ****     uint8_t uart_buffer[8];
  61              		.loc 1 149 5 view .LVU7
 150:../../application/src/fobFirmware.c ****     uart_write(HOST_UART, (uint8_t *)"P", 1);
  62              		.loc 1 150 5 view .LVU8
  63 000a 0122     		movs	r2, #1
  64 000c 1949     		ldr	r1, .L6
  65 000e 0020     		movs	r0, #0
  66              	.LVL1:
  67              		.loc 1 150 5 is_stmt 0 view .LVU9
  68 0010 FFF7FEFF 		bl	uart_write
  69              	.LVL2:
 151:../../application/src/fobFirmware.c ****     bytes_read = uart_readline(HOST_UART, uart_buffer);
  70              		.loc 1 151 5 is_stmt 1 view .LVU10
  71              		.loc 1 151 18 is_stmt 0 view .LVU11
  72 0014 6946     		mov	r1, sp
  73 0016 0020     		movs	r0, #0
  74 0018 FFF7FEFF 		bl	uart_readline
  75              	.LVL3:
  76              		.loc 1 151 16 view .LVU12
  77 001c 00B2     		sxth	r0, r0
ARM GAS  /tmp/cc3QQpu6.s 			page 5


  78              	.LVL4:
 152:../../application/src/fobFirmware.c **** 
 153:../../application/src/fobFirmware.c ****     if (bytes_read == 6)
  79              		.loc 1 153 5 is_stmt 1 view .LVU13
  80              		.loc 1 153 8 is_stmt 0 view .LVU14
  81 001e 0628     		cmp	r0, #6
  82 0020 26D1     		bne	.L1
 154:../../application/src/fobFirmware.c ****     {
 155:../../application/src/fobFirmware.c ****       // If the pin is correct
 156:../../application/src/fobFirmware.c ****       if (!(strcmp((char *)uart_buffer,
  83              		.loc 1 156 7 is_stmt 1 view .LVU15
  84              		.loc 1 156 13 is_stmt 0 view .LVU16
  85 0022 04F11101 		add	r1, r4, #17
  86 0026 6846     		mov	r0, sp
  87              	.LVL5:
  88              		.loc 1 156 13 view .LVU17
  89 0028 FFF7FEFF 		bl	strcmp
  90              	.LVL6:
  91              		.loc 1 156 10 view .LVU18
  92 002c 00BB     		cbnz	r0, .L1
 157:../../application/src/fobFirmware.c ****                    (char *)fob_state_ram->pair_info.pin)))
 158:../../application/src/fobFirmware.c ****       {
 159:../../application/src/fobFirmware.c ****         // Pair the new key by sending a PAIR_PACKET structure
 160:../../application/src/fobFirmware.c ****         // with required information to unlock door
 161:../../application/src/fobFirmware.c ****         message.message_len = sizeof(PAIR_PACKET);
  93              		.loc 1 161 9 is_stmt 1 view .LVU19
  94              		.loc 1 161 29 is_stmt 0 view .LVU20
  95 002e 1823     		movs	r3, #24
  96 0030 8DF80930 		strb	r3, [sp, #9]
 162:../../application/src/fobFirmware.c ****         message.magic = PAIR_MAGIC;
  97              		.loc 1 162 9 is_stmt 1 view .LVU21
  98              		.loc 1 162 23 is_stmt 0 view .LVU22
  99 0034 5523     		movs	r3, #85
 100 0036 8DF80830 		strb	r3, [sp, #8]
 163:../../application/src/fobFirmware.c ****         message.buffer = (uint8_t *)&fob_state_ram->pair_info;
 101              		.loc 1 163 9 is_stmt 1 view .LVU23
 102              		.loc 1 163 37 is_stmt 0 view .LVU24
 103 003a 0134     		adds	r4, r4, #1
 104              	.LVL7:
 105              		.loc 1 163 24 view .LVU25
 106 003c 0394     		str	r4, [sp, #12]
 164:../../application/src/fobFirmware.c ****         send_board_message(&message);
 107              		.loc 1 164 9 is_stmt 1 view .LVU26
 108 003e 02A8     		add	r0, sp, #8
 109 0040 FFF7FEFF 		bl	send_board_message
 110              	.LVL8:
 111 0044 14E0     		b	.L1
 112              	.LVL9:
 113              	.L2:
 114              		.loc 1 164 9 is_stmt 0 view .LVU27
 115              	.LBE2:
 165:../../application/src/fobFirmware.c ****       }
 166:../../application/src/fobFirmware.c ****     }
 167:../../application/src/fobFirmware.c ****   }
 168:../../application/src/fobFirmware.c **** 
 169:../../application/src/fobFirmware.c ****   // Start pairing transaction - fob is not paired
 170:../../application/src/fobFirmware.c ****   else
ARM GAS  /tmp/cc3QQpu6.s 			page 6


 171:../../application/src/fobFirmware.c ****   {
 172:../../application/src/fobFirmware.c ****     message.buffer = (uint8_t *)&fob_state_ram->pair_info;
 116              		.loc 1 172 5 is_stmt 1 view .LVU28
 117              		.loc 1 172 33 is_stmt 0 view .LVU29
 118 0046 461C     		adds	r6, r0, #1
 119              		.loc 1 172 20 view .LVU30
 120 0048 0396     		str	r6, [sp, #12]
 173:../../application/src/fobFirmware.c ****     receive_board_message_by_type(&message, PAIR_MAGIC);
 121              		.loc 1 173 5 is_stmt 1 view .LVU31
 122 004a 5521     		movs	r1, #85
 123 004c 02A8     		add	r0, sp, #8
 124              	.LVL10:
 125              		.loc 1 173 5 is_stmt 0 view .LVU32
 126 004e FFF7FEFF 		bl	receive_board_message_by_type
 127              	.LVL11:
 174:../../application/src/fobFirmware.c ****     fob_state_ram->paired = FLASH_PAIRED;
 128              		.loc 1 174 5 is_stmt 1 view .LVU33
 129              		.loc 1 174 27 is_stmt 0 view .LVU34
 130 0052 0025     		movs	r5, #0
 131 0054 2046     		mov	r0, r4
 132 0056 00F8195B 		strb	r5, [r0], #25
 175:../../application/src/fobFirmware.c ****     strcpy((char *)fob_state_ram->feature_info.car_id,
 133              		.loc 1 175 5 is_stmt 1 view .LVU35
 134 005a 3146     		mov	r1, r6
 135 005c FFF7FEFF 		bl	strcpy
 136              	.LVL12:
 176:../../application/src/fobFirmware.c ****            (char *)fob_state_ram->pair_info.car_id);
 177:../../application/src/fobFirmware.c **** 
 178:../../application/src/fobFirmware.c ****     uart_write(HOST_UART, (uint8_t *)"Paired", 6);
 137              		.loc 1 178 5 view .LVU36
 138 0060 0622     		movs	r2, #6
 139 0062 0549     		ldr	r1, .L6+4
 140 0064 2846     		mov	r0, r5
 141 0066 FFF7FEFF 		bl	uart_write
 142              	.LVL13:
 179:../../application/src/fobFirmware.c **** 
 180:../../application/src/fobFirmware.c ****     saveFobState(fob_state_ram);
 143              		.loc 1 180 5 view .LVU37
 144 006a 2046     		mov	r0, r4
 145 006c FFF7FEFF 		bl	saveFobState
 146              	.LVL14:
 147              	.L1:
 181:../../application/src/fobFirmware.c ****   }
 182:../../application/src/fobFirmware.c **** }
 148              		.loc 1 182 1 is_stmt 0 view .LVU38
 149 0070 04B0     		add	sp, sp, #16
 150              	.LCFI2:
 151              		.cfi_def_cfa_offset 16
 152              		@ sp needed
 153 0072 70BD     		pop	{r4, r5, r6, pc}
 154              	.L7:
 155              		.align	2
 156              	.L6:
 157 0074 00000000 		.word	.LC0
 158 0078 04000000 		.word	.LC1
 159              		.cfi_endproc
 160              	.LFE1:
ARM GAS  /tmp/cc3QQpu6.s 			page 7


 162              		.section	.rodata.enableFeature.str1.4,"aMS",%progbits,1
 163              		.align	2
 164              	.LC2:
 165 0000 456E6162 		.ascii	"Enabled\000"
 165      6C656400 
 166              		.section	.text.enableFeature,"ax",%progbits
 167              		.align	1
 168              		.global	enableFeature
 169              		.syntax unified
 170              		.thumb
 171              		.thumb_func
 172              		.fpu fpv4-sp-d16
 174              	enableFeature:
 175              	.LVL15:
 176              	.LFB2:
 183:../../application/src/fobFirmware.c **** 
 184:../../application/src/fobFirmware.c **** /**
 185:../../application/src/fobFirmware.c ****  * @brief Function that handles enabling a new feature on the fob
 186:../../application/src/fobFirmware.c ****  *
 187:../../application/src/fobFirmware.c ****  * @param fob_state_ram pointer to the current fob state in ram
 188:../../application/src/fobFirmware.c ****  */
 189:../../application/src/fobFirmware.c **** void enableFeature(FLASH_DATA *fob_state_ram)
 190:../../application/src/fobFirmware.c **** {
 177              		.loc 1 190 1 is_stmt 1 view -0
 178              		.cfi_startproc
 179              		@ args = 0, pretend = 0, frame = 24
 180              		@ frame_needed = 0, uses_anonymous_args = 0
 191:../../application/src/fobFirmware.c ****   if (fob_state_ram->paired == FLASH_PAIRED)
 181              		.loc 1 191 3 view .LVU40
 182              		.loc 1 191 20 is_stmt 0 view .LVU41
 183 0000 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
 184              		.loc 1 191 6 view .LVU42
 185 0002 03B1     		cbz	r3, .L17
 186 0004 7047     		bx	lr
 187              	.L17:
 190:../../application/src/fobFirmware.c ****   if (fob_state_ram->paired == FLASH_PAIRED)
 188              		.loc 1 190 1 view .LVU43
 189 0006 10B5     		push	{r4, lr}
 190              	.LCFI3:
 191              		.cfi_def_cfa_offset 8
 192              		.cfi_offset 4, -8
 193              		.cfi_offset 14, -4
 194 0008 86B0     		sub	sp, sp, #24
 195              	.LCFI4:
 196              		.cfi_def_cfa_offset 32
 197 000a 0446     		mov	r4, r0
 198              	.LBB3:
 192:../../application/src/fobFirmware.c ****   {
 193:../../application/src/fobFirmware.c ****     uint8_t uart_buffer[20];
 199              		.loc 1 193 5 is_stmt 1 view .LVU44
 194:../../application/src/fobFirmware.c ****     uart_readline(HOST_UART, uart_buffer);
 200              		.loc 1 194 5 view .LVU45
 201 000c 01A9     		add	r1, sp, #4
 202 000e 0020     		movs	r0, #0
 203              	.LVL16:
 204              		.loc 1 194 5 is_stmt 0 view .LVU46
 205 0010 FFF7FEFF 		bl	uart_readline
ARM GAS  /tmp/cc3QQpu6.s 			page 8


 206              	.LVL17:
 195:../../application/src/fobFirmware.c **** 
 196:../../application/src/fobFirmware.c ****     ENABLE_PACKET *enable_message = (ENABLE_PACKET *)uart_buffer;
 207              		.loc 1 196 5 is_stmt 1 view .LVU47
 197:../../application/src/fobFirmware.c ****     if (strcmp((char *)fob_state_ram->pair_info.car_id,
 208              		.loc 1 197 5 view .LVU48
 209              		.loc 1 197 9 is_stmt 0 view .LVU49
 210 0014 01A9     		add	r1, sp, #4
 211              	.LVL18:
 212              		.loc 1 197 9 view .LVU50
 213 0016 601C     		adds	r0, r4, #1
 214 0018 FFF7FEFF 		bl	strcmp
 215              	.LVL19:
 216              		.loc 1 197 8 view .LVU51
 217 001c 0346     		mov	r3, r0
 218 001e F0B9     		cbnz	r0, .L8
 198:../../application/src/fobFirmware.c ****                (char *)enable_message->car_id))
 199:../../application/src/fobFirmware.c ****     {
 200:../../application/src/fobFirmware.c ****       return;
 201:../../application/src/fobFirmware.c ****     }
 202:../../application/src/fobFirmware.c **** 
 203:../../application/src/fobFirmware.c ****     // Feature list full
 204:../../application/src/fobFirmware.c ****     if (fob_state_ram->feature_info.num_active == NUM_FEATURES)
 219              		.loc 1 204 5 is_stmt 1 view .LVU52
 220              		.loc 1 204 36 is_stmt 0 view .LVU53
 221 0020 94F82100 		ldrb	r0, [r4, #33]	@ zero_extendqisi2
 222              		.loc 1 204 8 view .LVU54
 223 0024 0328     		cmp	r0, #3
 224 0026 1AD0     		beq	.L8
 225              	.L11:
 226              	.LVL20:
 227              	.LBB4:
 205:../../application/src/fobFirmware.c ****     {
 206:../../application/src/fobFirmware.c ****       return;
 207:../../application/src/fobFirmware.c ****     }
 208:../../application/src/fobFirmware.c **** 
 209:../../application/src/fobFirmware.c ****     // Search for feature in list
 210:../../application/src/fobFirmware.c ****     for (int i = 0; i < fob_state_ram->feature_info.num_active; i++)
 228              		.loc 1 210 21 is_stmt 1 discriminator 1 view .LVU55
 229              		.loc 1 210 5 is_stmt 0 discriminator 1 view .LVU56
 230 0028 9842     		cmp	r0, r3
 231 002a 08DD     		ble	.L18
 211:../../application/src/fobFirmware.c ****     {
 212:../../application/src/fobFirmware.c ****       if (fob_state_ram->feature_info.features[i] == enable_message->feature)
 232              		.loc 1 212 7 is_stmt 1 view .LVU57
 233              		.loc 1 212 47 is_stmt 0 view .LVU58
 234 002c E218     		adds	r2, r4, r3
 235 002e 92F82210 		ldrb	r1, [r2, #34]	@ zero_extendqisi2
 236              		.loc 1 212 68 view .LVU59
 237 0032 9DF80C20 		ldrb	r2, [sp, #12]	@ zero_extendqisi2
 238              		.loc 1 212 10 view .LVU60
 239 0036 9142     		cmp	r1, r2
 240 0038 11D0     		beq	.L8
 210:../../application/src/fobFirmware.c ****     {
 241              		.loc 1 210 65 is_stmt 1 discriminator 2 view .LVU61
 210:../../application/src/fobFirmware.c ****     {
 242              		.loc 1 210 66 is_stmt 0 discriminator 2 view .LVU62
ARM GAS  /tmp/cc3QQpu6.s 			page 9


 243 003a 0133     		adds	r3, r3, #1
 244              	.LVL21:
 210:../../application/src/fobFirmware.c ****     {
 245              		.loc 1 210 66 discriminator 2 view .LVU63
 246 003c F4E7     		b	.L11
 247              	.L18:
 210:../../application/src/fobFirmware.c ****     {
 248              		.loc 1 210 66 discriminator 2 view .LVU64
 249              	.LBE4:
 213:../../application/src/fobFirmware.c ****       {
 214:../../application/src/fobFirmware.c ****         return;
 215:../../application/src/fobFirmware.c ****       }
 216:../../application/src/fobFirmware.c ****     }
 217:../../application/src/fobFirmware.c **** 
 218:../../application/src/fobFirmware.c ****     fob_state_ram->feature_info
 250              		.loc 1 218 5 is_stmt 1 view .LVU65
 219:../../application/src/fobFirmware.c ****         .features[fob_state_ram->feature_info.num_active] =
 220:../../application/src/fobFirmware.c ****         enable_message->feature;
 251              		.loc 1 220 23 is_stmt 0 view .LVU66
 252 003e 9DF80C20 		ldrb	r2, [sp, #12]	@ zero_extendqisi2
 219:../../application/src/fobFirmware.c ****         .features[fob_state_ram->feature_info.num_active] =
 253              		.loc 1 219 59 view .LVU67
 254 0042 2318     		adds	r3, r4, r0
 255              	.LVL22:
 219:../../application/src/fobFirmware.c ****         .features[fob_state_ram->feature_info.num_active] =
 256              		.loc 1 219 59 view .LVU68
 257 0044 83F82220 		strb	r2, [r3, #34]
 221:../../application/src/fobFirmware.c ****     fob_state_ram->feature_info.num_active++;
 258              		.loc 1 221 5 is_stmt 1 view .LVU69
 259              		.loc 1 221 43 is_stmt 0 view .LVU70
 260 0048 0130     		adds	r0, r0, #1
 261 004a 84F82100 		strb	r0, [r4, #33]
 222:../../application/src/fobFirmware.c **** 
 223:../../application/src/fobFirmware.c ****     saveFobState(fob_state_ram);
 262              		.loc 1 223 5 is_stmt 1 view .LVU71
 263 004e 2046     		mov	r0, r4
 264 0050 FFF7FEFF 		bl	saveFobState
 265              	.LVL23:
 224:../../application/src/fobFirmware.c ****     uart_write(HOST_UART, (uint8_t *)"Enabled", 7);
 266              		.loc 1 224 5 view .LVU72
 267 0054 0722     		movs	r2, #7
 268 0056 0349     		ldr	r1, .L19
 269 0058 0020     		movs	r0, #0
 270 005a FFF7FEFF 		bl	uart_write
 271              	.LVL24:
 272              	.L8:
 273              		.loc 1 224 5 is_stmt 0 view .LVU73
 274              	.LBE3:
 225:../../application/src/fobFirmware.c ****   }
 226:../../application/src/fobFirmware.c **** }
 275              		.loc 1 226 1 view .LVU74
 276 005e 06B0     		add	sp, sp, #24
 277              	.LCFI5:
 278              		.cfi_def_cfa_offset 8
 279              		@ sp needed
 280 0060 10BD     		pop	{r4, pc}
 281              	.LVL25:
ARM GAS  /tmp/cc3QQpu6.s 			page 10


 282              	.L20:
 283              		.loc 1 226 1 view .LVU75
 284 0062 00BF     		.align	2
 285              	.L19:
 286 0064 00000000 		.word	.LC2
 287              		.cfi_endproc
 288              	.LFE2:
 290              		.section	.text.unlockCar,"ax",%progbits
 291              		.align	1
 292              		.global	unlockCar
 293              		.syntax unified
 294              		.thumb
 295              		.thumb_func
 296              		.fpu fpv4-sp-d16
 298              	unlockCar:
 299              	.LVL26:
 300              	.LFB3:
 227:../../application/src/fobFirmware.c **** 
 228:../../application/src/fobFirmware.c **** /**
 229:../../application/src/fobFirmware.c ****  * @brief Function that handles the fob unlocking a car
 230:../../application/src/fobFirmware.c ****  *
 231:../../application/src/fobFirmware.c ****  * @param fob_state_ram pointer to the current fob state in ram
 232:../../application/src/fobFirmware.c ****  */
 233:../../application/src/fobFirmware.c **** void unlockCar(FLASH_DATA *fob_state_ram)
 234:../../application/src/fobFirmware.c **** {
 301              		.loc 1 234 1 is_stmt 1 view -0
 302              		.cfi_startproc
 303              		@ args = 0, pretend = 0, frame = 8
 304              		@ frame_needed = 0, uses_anonymous_args = 0
 235:../../application/src/fobFirmware.c ****   if (fob_state_ram->paired == FLASH_PAIRED)
 305              		.loc 1 235 3 view .LVU77
 306              		.loc 1 235 20 is_stmt 0 view .LVU78
 307 0000 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
 308              		.loc 1 235 6 view .LVU79
 309 0002 03B1     		cbz	r3, .L27
 310 0004 7047     		bx	lr
 311              	.L27:
 234:../../application/src/fobFirmware.c ****   if (fob_state_ram->paired == FLASH_PAIRED)
 312              		.loc 1 234 1 view .LVU80
 313 0006 00B5     		push	{lr}
 314              	.LCFI6:
 315              		.cfi_def_cfa_offset 4
 316              		.cfi_offset 14, -4
 317 0008 83B0     		sub	sp, sp, #12
 318              	.LCFI7:
 319              		.cfi_def_cfa_offset 16
 320              	.LBB5:
 236:../../application/src/fobFirmware.c ****   {
 237:../../application/src/fobFirmware.c ****     MESSAGE_PACKET message;
 321              		.loc 1 237 5 is_stmt 1 view .LVU81
 238:../../application/src/fobFirmware.c ****     message.message_len = 6;
 322              		.loc 1 238 5 view .LVU82
 323              		.loc 1 238 25 is_stmt 0 view .LVU83
 324 000a 0623     		movs	r3, #6
 325 000c 8DF80130 		strb	r3, [sp, #1]
 239:../../application/src/fobFirmware.c ****     message.magic = UNLOCK_MAGIC;
 326              		.loc 1 239 5 is_stmt 1 view .LVU84
ARM GAS  /tmp/cc3QQpu6.s 			page 11


 327              		.loc 1 239 19 is_stmt 0 view .LVU85
 328 0010 5623     		movs	r3, #86
 329 0012 8DF80030 		strb	r3, [sp]
 240:../../application/src/fobFirmware.c ****     message.buffer = fob_state_ram->pair_info.password;
 330              		.loc 1 240 5 is_stmt 1 view .LVU86
 331              		.loc 1 240 22 is_stmt 0 view .LVU87
 332 0016 0930     		adds	r0, r0, #9
 333              	.LVL27:
 334              		.loc 1 240 20 view .LVU88
 335 0018 0190     		str	r0, [sp, #4]
 241:../../application/src/fobFirmware.c **** 
 242:../../application/src/fobFirmware.c ****     send_board_message(&message);
 336              		.loc 1 242 5 is_stmt 1 view .LVU89
 337 001a 6846     		mov	r0, sp
 338              	.LVL28:
 339              		.loc 1 242 5 is_stmt 0 view .LVU90
 340 001c FFF7FEFF 		bl	send_board_message
 341              	.LVL29:
 342              		.loc 1 242 5 view .LVU91
 343              	.LBE5:
 243:../../application/src/fobFirmware.c ****   }
 244:../../application/src/fobFirmware.c **** }
 344              		.loc 1 244 1 view .LVU92
 345 0020 03B0     		add	sp, sp, #12
 346              	.LCFI8:
 347              		.cfi_def_cfa_offset 4
 348              		@ sp needed
 349 0022 5DF804FB 		ldr	pc, [sp], #4
 350              		.cfi_endproc
 351              	.LFE3:
 353              		.section	.text.startCar,"ax",%progbits
 354              		.align	1
 355              		.global	startCar
 356              		.syntax unified
 357              		.thumb
 358              		.thumb_func
 359              		.fpu fpv4-sp-d16
 361              	startCar:
 362              	.LVL30:
 363              	.LFB4:
 245:../../application/src/fobFirmware.c **** 
 246:../../application/src/fobFirmware.c **** /**
 247:../../application/src/fobFirmware.c ****  * @brief Function that handles the fob starting a car
 248:../../application/src/fobFirmware.c ****  *
 249:../../application/src/fobFirmware.c ****  * @param fob_state_ram pointer to the current fob state in ram
 250:../../application/src/fobFirmware.c ****  */
 251:../../application/src/fobFirmware.c **** void startCar(FLASH_DATA *fob_state_ram)
 252:../../application/src/fobFirmware.c **** {
 364              		.loc 1 252 1 is_stmt 1 view -0
 365              		.cfi_startproc
 366              		@ args = 0, pretend = 0, frame = 8
 367              		@ frame_needed = 0, uses_anonymous_args = 0
 253:../../application/src/fobFirmware.c ****   if (fob_state_ram->paired == FLASH_PAIRED)
 368              		.loc 1 253 3 view .LVU94
 369              		.loc 1 253 20 is_stmt 0 view .LVU95
 370 0000 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
 371              		.loc 1 253 6 view .LVU96
ARM GAS  /tmp/cc3QQpu6.s 			page 12


 372 0002 03B1     		cbz	r3, .L34
 373 0004 7047     		bx	lr
 374              	.L34:
 252:../../application/src/fobFirmware.c ****   if (fob_state_ram->paired == FLASH_PAIRED)
 375              		.loc 1 252 1 view .LVU97
 376 0006 00B5     		push	{lr}
 377              	.LCFI9:
 378              		.cfi_def_cfa_offset 4
 379              		.cfi_offset 14, -4
 380 0008 83B0     		sub	sp, sp, #12
 381              	.LCFI10:
 382              		.cfi_def_cfa_offset 16
 383              	.LBB6:
 254:../../application/src/fobFirmware.c ****   {
 255:../../application/src/fobFirmware.c ****     MESSAGE_PACKET message;
 384              		.loc 1 255 5 is_stmt 1 view .LVU98
 256:../../application/src/fobFirmware.c ****     message.magic = START_MAGIC;
 385              		.loc 1 256 5 view .LVU99
 386              		.loc 1 256 19 is_stmt 0 view .LVU100
 387 000a 5723     		movs	r3, #87
 388 000c 8DF80030 		strb	r3, [sp]
 257:../../application/src/fobFirmware.c ****     message.message_len = sizeof(FEATURE_DATA);
 389              		.loc 1 257 5 is_stmt 1 view .LVU101
 390              		.loc 1 257 25 is_stmt 0 view .LVU102
 391 0010 0C23     		movs	r3, #12
 392 0012 8DF80130 		strb	r3, [sp, #1]
 258:../../application/src/fobFirmware.c ****     message.buffer = (uint8_t *)&fob_state_ram->feature_info;  
 393              		.loc 1 258 5 is_stmt 1 view .LVU103
 394              		.loc 1 258 33 is_stmt 0 view .LVU104
 395 0016 1930     		adds	r0, r0, #25
 396              	.LVL31:
 397              		.loc 1 258 20 view .LVU105
 398 0018 0190     		str	r0, [sp, #4]
 259:../../application/src/fobFirmware.c **** 
 260:../../application/src/fobFirmware.c ****     send_board_message(&message);
 399              		.loc 1 260 5 is_stmt 1 view .LVU106
 400 001a 6846     		mov	r0, sp
 401              	.LVL32:
 402              		.loc 1 260 5 is_stmt 0 view .LVU107
 403 001c FFF7FEFF 		bl	send_board_message
 404              	.LVL33:
 405              		.loc 1 260 5 view .LVU108
 406              	.LBE6:
 261:../../application/src/fobFirmware.c ****   }
 262:../../application/src/fobFirmware.c **** }
 407              		.loc 1 262 1 view .LVU109
 408 0020 03B0     		add	sp, sp, #12
 409              	.LCFI11:
 410              		.cfi_def_cfa_offset 4
 411              		@ sp needed
 412 0022 5DF804FB 		ldr	pc, [sp], #4
 413              		.cfi_endproc
 414              	.LFE4:
 416              		.section	.text.receiveAck,"ax",%progbits
 417              		.align	1
 418              		.global	receiveAck
 419              		.syntax unified
ARM GAS  /tmp/cc3QQpu6.s 			page 13


 420              		.thumb
 421              		.thumb_func
 422              		.fpu fpv4-sp-d16
 424              	receiveAck:
 425              	.LFB5:
 263:../../application/src/fobFirmware.c **** 
 264:../../application/src/fobFirmware.c **** /**
 265:../../application/src/fobFirmware.c ****  * @brief Function that receives an ack and returns whether ack was
 266:../../application/src/fobFirmware.c ****  * success/failure
 267:../../application/src/fobFirmware.c ****  *
 268:../../application/src/fobFirmware.c ****  * @return uint8_t Ack success/failure
 269:../../application/src/fobFirmware.c ****  */
 270:../../application/src/fobFirmware.c **** uint8_t receiveAck()
 271:../../application/src/fobFirmware.c **** {
 426              		.loc 1 271 1 is_stmt 1 view -0
 427              		.cfi_startproc
 428              		@ args = 0, pretend = 0, frame = 264
 429              		@ frame_needed = 0, uses_anonymous_args = 0
 430 0000 00B5     		push	{lr}
 431              	.LCFI12:
 432              		.cfi_def_cfa_offset 4
 433              		.cfi_offset 14, -4
 434 0002 C3B0     		sub	sp, sp, #268
 435              	.LCFI13:
 436              		.cfi_def_cfa_offset 272
 272:../../application/src/fobFirmware.c ****   MESSAGE_PACKET message;
 437              		.loc 1 272 3 view .LVU111
 273:../../application/src/fobFirmware.c ****   uint8_t buffer[255];
 438              		.loc 1 273 3 view .LVU112
 274:../../application/src/fobFirmware.c ****   message.buffer = buffer;
 439              		.loc 1 274 3 view .LVU113
 440              		.loc 1 274 18 is_stmt 0 view .LVU114
 441 0004 CDF804D1 		str	sp, [sp, #260]
 275:../../application/src/fobFirmware.c ****   receive_board_message_by_type(&message, ACK_MAGIC);
 442              		.loc 1 275 3 is_stmt 1 view .LVU115
 443 0008 5421     		movs	r1, #84
 444 000a 40A8     		add	r0, sp, #256
 445 000c FFF7FEFF 		bl	receive_board_message_by_type
 446              	.LVL34:
 276:../../application/src/fobFirmware.c **** 
 277:../../application/src/fobFirmware.c ****   return message.buffer[0];
 447              		.loc 1 277 3 view .LVU116
 278:../../application/src/fobFirmware.c **** }...
 448              		.loc 1 278 1 is_stmt 0 view .LVU117
 449 0010 419B     		ldr	r3, [sp, #260]
 450 0012 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
 451 0014 43B0     		add	sp, sp, #268
 452              	.LCFI14:
 453              		.cfi_def_cfa_offset 4
 454              		@ sp needed
 455 0016 5DF804FB 		ldr	pc, [sp], #4
 456              		.cfi_endproc
 457              	.LFE5:
 459              		.section	.rodata.main.str1.4,"aMS",%progbits,1
 460              		.align	2
 461              	.LC3:
 462 0000 666F625F 		.ascii	"fob_state\000"
ARM GAS  /tmp/cc3QQpu6.s 			page 14


 462      73746174 
 462      6500
 463 000a 0000     		.align	2
 464              	.LC4:
 465 000c 756E6C6F 		.ascii	"unlock\000"
 465      636B00
 466 0013 00       		.align	2
 467              	.LC5:
 468 0014 31323334 		.ascii	"123456\000"
 468      353600
 469 001b 00       		.align	2
 470              	.LC6:
 471 001c 35343031 		.ascii	"5401\000"
 471      00
 472 0021 000000   		.align	2
 473              	.LC7:
 474 0024 656E6162 		.ascii	"enable\000"
 474      6C6500
 475 002b 00       		.align	2
 476              	.LC8:
 477 002c 70616972 		.ascii	"pair\000"
 477      00
 478              		.section	.text.main,"ax",%progbits
 479              		.align	1
 480              		.global	main
 481              		.syntax unified
 482              		.thumb
 483              		.thumb_func
 484              		.fpu fpv4-sp-d16
 486              	main:
 487              	.LVL35:
 488              	.LFB0:
  52:../../application/src/fobFirmware.c **** {
 489              		.loc 1 52 1 is_stmt 1 view -0
 490              		.cfi_startproc
 491              		@ args = 0, pretend = 0, frame = 56
 492              		@ frame_needed = 0, uses_anonymous_args = 0
  52:../../application/src/fobFirmware.c **** {
 493              		.loc 1 52 1 is_stmt 0 view .LVU119
 494 0000 10B5     		push	{r4, lr}
 495              	.LCFI15:
 496              		.cfi_def_cfa_offset 8
 497              		.cfi_offset 4, -8
 498              		.cfi_offset 14, -4
 499 0002 8EB0     		sub	sp, sp, #56
 500              	.LCFI16:
 501              		.cfi_def_cfa_offset 64
  53:../../application/src/fobFirmware.c ****   initHardware_fob(argc, argv);
 502              		.loc 1 53 3 is_stmt 1 view .LVU120
 503 0004 FFF7FEFF 		bl	initHardware_fob
 504              	.LVL36:
  55:../../application/src/fobFirmware.c ****   FLASH_DATA fob_state_ram;
 505              		.loc 1 55 3 view .LVU121
  58:../../application/src/fobFirmware.c ****   readVar((uint8_t*)(&fob_state_ram), "fob_state");
 506              		.loc 1 58 3 view .LVU122
 507 0008 3D49     		ldr	r1, .L52
 508 000a 04A8     		add	r0, sp, #16
ARM GAS  /tmp/cc3QQpu6.s 			page 15


 509 000c FFF7FEFF 		bl	readVar
 510              	.LVL37:
  63:../../application/src/fobFirmware.c ****   if (fob_state_ram.paired == FLASH_UNPAIRED)
 511              		.loc 1 63 3 view .LVU123
  63:../../application/src/fobFirmware.c ****   if (fob_state_ram.paired == FLASH_UNPAIRED)
 512              		.loc 1 63 20 is_stmt 0 view .LVU124
 513 0010 9DF81030 		ldrb	r3, [sp, #16]	@ zero_extendqisi2
  63:../../application/src/fobFirmware.c ****   if (fob_state_ram.paired == FLASH_UNPAIRED)
 514              		.loc 1 63 6 view .LVU125
 515 0014 FF2B     		cmp	r3, #255
 516 0016 18D0     		beq	.L47
 517              	.L38:
  85:../../application/src/fobFirmware.c ****   if (fob_state_ram.feature_info.num_active == 0xFF)
 518              		.loc 1 85 3 is_stmt 1 view .LVU126
  85:../../application/src/fobFirmware.c ****   if (fob_state_ram.feature_info.num_active == 0xFF)
 519              		.loc 1 85 33 is_stmt 0 view .LVU127
 520 0018 9DF83130 		ldrb	r3, [sp, #49]	@ zero_extendqisi2
  85:../../application/src/fobFirmware.c ****   if (fob_state_ram.feature_info.num_active == 0xFF)
 521              		.loc 1 85 6 view .LVU128
 522 001c FF2B     		cmp	r3, #255
 523 001e 3AD0     		beq	.L48
 524              	.L39:
  52:../../application/src/fobFirmware.c **** {
 525              		.loc 1 52 1 view .LVU129
 526 0020 0024     		movs	r4, #0
 527              	.L40:
 528              	.LVL38:
  96:../../application/src/fobFirmware.c ****   while (true)
 529              		.loc 1 96 3 is_stmt 1 view .LVU130
 100:../../application/src/fobFirmware.c ****     if (uart_avail(HOST_UART))
 530              		.loc 1 100 5 view .LVU131
 100:../../application/src/fobFirmware.c ****     if (uart_avail(HOST_UART))
 531              		.loc 1 100 9 is_stmt 0 view .LVU132
 532 0022 0020     		movs	r0, #0
 533 0024 FFF7FEFF 		bl	uart_avail
 534              	.LVL39:
 100:../../application/src/fobFirmware.c ****     if (uart_avail(HOST_UART))
 535              		.loc 1 100 8 view .LVU133
 536 0028 0028     		cmp	r0, #0
 537 002a 3BD1     		bne	.L49
 538              	.LVL40:
 539              	.L41:
 126:../../application/src/fobFirmware.c ****     if(buttonPressed())
 540              		.loc 1 126 5 is_stmt 1 view .LVU134
 126:../../application/src/fobFirmware.c ****     if(buttonPressed())
 541              		.loc 1 126 8 is_stmt 0 view .LVU135
 542 002c FFF7FEFF 		bl	buttonPressed
 543              	.LVL41:
 126:../../application/src/fobFirmware.c ****     if(buttonPressed())
 544              		.loc 1 126 7 view .LVU136
 545 0030 0028     		cmp	r0, #0
 546 0032 F6D0     		beq	.L40
 128:../../application/src/fobFirmware.c ****       unlockCar(&fob_state_ram);
 547              		.loc 1 128 7 is_stmt 1 view .LVU137
 548 0034 04A8     		add	r0, sp, #16
 549 0036 FFF7FEFF 		bl	unlockCar
 550              	.LVL42:
ARM GAS  /tmp/cc3QQpu6.s 			page 16


 129:../../application/src/fobFirmware.c ****       if (receiveAck())
 551              		.loc 1 129 7 view .LVU138
 129:../../application/src/fobFirmware.c ****       if (receiveAck())
 552              		.loc 1 129 11 is_stmt 0 view .LVU139
 553 003a FFF7FEFF 		bl	receiveAck
 554              	.LVL43:
 129:../../application/src/fobFirmware.c ****       if (receiveAck())
 555              		.loc 1 129 10 view .LVU140
 556 003e 0028     		cmp	r0, #0
 557 0040 EFD0     		beq	.L40
 131:../../application/src/fobFirmware.c ****         startCar(&fob_state_ram);
 558              		.loc 1 131 9 is_stmt 1 view .LVU141
 559 0042 04A8     		add	r0, sp, #16
 560 0044 FFF7FEFF 		bl	startCar
 561              	.LVL44:
 562 0048 EBE7     		b	.L40
 563              	.LVL45:
 564              	.L47:
  65:../../application/src/fobFirmware.c ****     strcpy((char *)(fob_state_ram.pair_info.password), PASSWORD);
 565              		.loc 1 65 5 view .LVU142
 566 004a 2E4B     		ldr	r3, .L52+4
 567 004c 1868     		ldr	r0, [r3]
 568 004e CDF81900 		str	r0, [sp, #25]	@ unaligned
 569 0052 9A88     		ldrh	r2, [r3, #4]	@ unaligned
 570 0054 9B79     		ldrb	r3, [r3, #6]	@ zero_extendqisi2
 571 0056 ADF81D20 		strh	r2, [sp, #29]	@ unaligned
 572 005a 8DF81F30 		strb	r3, [sp, #31]
  66:../../application/src/fobFirmware.c ****     strcpy((char *)(fob_state_ram.pair_info.pin), PAIR_PIN);
 573              		.loc 1 66 5 view .LVU143
 574 005e 2A4B     		ldr	r3, .L52+8
 575 0060 1868     		ldr	r0, [r3]
 576 0062 CDF82100 		str	r0, [sp, #33]	@ unaligned
 577 0066 9A88     		ldrh	r2, [r3, #4]	@ unaligned
 578 0068 9B79     		ldrb	r3, [r3, #6]	@ zero_extendqisi2
 579 006a ADF82520 		strh	r2, [sp, #37]	@ unaligned
 580 006e 8DF82730 		strb	r3, [sp, #39]
  67:../../application/src/fobFirmware.c ****     strcpy((char *)(fob_state_ram.pair_info.car_id), CAR_ID);
 581              		.loc 1 67 5 view .LVU144
 582 0072 264B     		ldr	r3, .L52+12
 583 0074 1868     		ldr	r0, [r3]
 584 0076 CDF81100 		str	r0, [sp, #17]	@ unaligned
 585 007a 1B79     		ldrb	r3, [r3, #4]	@ zero_extendqisi2
 586 007c 8DF81530 		strb	r3, [sp, #21]
  68:../../application/src/fobFirmware.c ****     strcpy((char *)(fob_state_ram.feature_info.car_id), CAR_ID);
 587              		.loc 1 68 5 view .LVU145
 588 0080 CDF82900 		str	r0, [sp, #41]	@ unaligned
 589 0084 8DF82D30 		strb	r3, [sp, #45]
  69:../../application/src/fobFirmware.c ****     fob_state_ram.paired = FLASH_PAIRED;
 590              		.loc 1 69 5 view .LVU146
  69:../../application/src/fobFirmware.c ****     fob_state_ram.paired = FLASH_PAIRED;
 591              		.loc 1 69 26 is_stmt 0 view .LVU147
 592 0088 0023     		movs	r3, #0
 593 008a 8DF81030 		strb	r3, [sp, #16]
  71:../../application/src/fobFirmware.c ****     saveFobState(&fob_state_ram);
 594              		.loc 1 71 5 is_stmt 1 view .LVU148
 595 008e 04A8     		add	r0, sp, #16
 596 0090 FFF7FEFF 		bl	saveFobState
ARM GAS  /tmp/cc3QQpu6.s 			page 17


 597              	.LVL46:
 598 0094 C0E7     		b	.L38
 599              	.L48:
  87:../../application/src/fobFirmware.c ****     fob_state_ram.feature_info.num_active = 0;
 600              		.loc 1 87 5 view .LVU149
  87:../../application/src/fobFirmware.c ****     fob_state_ram.feature_info.num_active = 0;
 601              		.loc 1 87 43 is_stmt 0 view .LVU150
 602 0096 0023     		movs	r3, #0
 603 0098 8DF83130 		strb	r3, [sp, #49]
  88:../../application/src/fobFirmware.c ****     saveFobState(&fob_state_ram);
 604              		.loc 1 88 5 is_stmt 1 view .LVU151
 605 009c 04A8     		add	r0, sp, #16
 606 009e FFF7FEFF 		bl	saveFobState
 607              	.LVL47:
 608 00a2 BDE7     		b	.L39
 609              	.LVL48:
 610              	.L49:
 611              	.LBB7:
 102:../../application/src/fobFirmware.c ****       uint8_t uart_char = (uint8_t)uart_readb(HOST_UART);
 612              		.loc 1 102 7 view .LVU152
 102:../../application/src/fobFirmware.c ****       uint8_t uart_char = (uint8_t)uart_readb(HOST_UART);
 613              		.loc 1 102 36 is_stmt 0 view .LVU153
 614 00a4 0020     		movs	r0, #0
 615 00a6 FFF7FEFF 		bl	uart_readb
 616              	.LVL49:
 102:../../application/src/fobFirmware.c ****       uint8_t uart_char = (uint8_t)uart_readb(HOST_UART);
 617              		.loc 1 102 15 view .LVU154
 618 00aa C0B2     		uxtb	r0, r0
 619              	.LVL50:
 104:../../application/src/fobFirmware.c ****       if ((uart_char != '\r') && (uart_char != '\n') && (uart_char != '\0') &&
 620              		.loc 1 104 7 is_stmt 1 view .LVU155
 104:../../application/src/fobFirmware.c ****       if ((uart_char != '\r') && (uart_char != '\n') && (uart_char != '\0') &&
 621              		.loc 1 104 10 is_stmt 0 view .LVU156
 622 00ac 0D28     		cmp	r0, #13
 623 00ae 0AD0     		beq	.L42
 104:../../application/src/fobFirmware.c ****       if ((uart_char != '\r') && (uart_char != '\n') && (uart_char != '\0') &&
 624              		.loc 1 104 31 discriminator 1 view .LVU157
 625 00b0 0A28     		cmp	r0, #10
 626 00b2 08D0     		beq	.L42
 104:../../application/src/fobFirmware.c ****       if ((uart_char != '\r') && (uart_char != '\n') && (uart_char != '\0') &&
 627              		.loc 1 104 54 discriminator 2 view .LVU158
 628 00b4 38B1     		cbz	r0, .L42
 107:../../application/src/fobFirmware.c ****         uart_buffer[uart_buffer_index] = uart_char;
 629              		.loc 1 107 9 is_stmt 1 view .LVU159
 107:../../application/src/fobFirmware.c ****         uart_buffer[uart_buffer_index] = uart_char;
 630              		.loc 1 107 40 is_stmt 0 view .LVU160
 631 00b6 04F13803 		add	r3, r4, #56
 632 00ba 6B44     		add	r3, sp, r3
 633 00bc 03F8340C 		strb	r0, [r3, #-52]
 108:../../application/src/fobFirmware.c ****         uart_buffer_index++;
 634              		.loc 1 108 9 is_stmt 1 view .LVU161
 108:../../application/src/fobFirmware.c ****         uart_buffer_index++;
 635              		.loc 1 108 26 is_stmt 0 view .LVU162
 636 00c0 0134     		adds	r4, r4, #1
 637              	.LVL51:
 108:../../application/src/fobFirmware.c ****         uart_buffer_index++;
 638              		.loc 1 108 26 view .LVU163
ARM GAS  /tmp/cc3QQpu6.s 			page 18


 639 00c2 E4B2     		uxtb	r4, r4
 640              	.LVL52:
 108:../../application/src/fobFirmware.c ****         uart_buffer_index++;
 641              		.loc 1 108 26 view .LVU164
 642 00c4 B2E7     		b	.L41
 643              	.L42:
 112:../../application/src/fobFirmware.c ****         uart_buffer[uart_buffer_index] = 0x00;
 644              		.loc 1 112 9 is_stmt 1 view .LVU165
 112:../../application/src/fobFirmware.c ****         uart_buffer[uart_buffer_index] = 0x00;
 645              		.loc 1 112 40 is_stmt 0 view .LVU166
 646 00c6 04F13803 		add	r3, r4, #56
 647 00ca 0DEB0304 		add	r4, sp, r3
 648              	.LVL53:
 112:../../application/src/fobFirmware.c ****         uart_buffer[uart_buffer_index] = 0x00;
 649              		.loc 1 112 40 view .LVU167
 650 00ce 0023     		movs	r3, #0
 651 00d0 04F8343C 		strb	r3, [r4, #-52]
 113:../../application/src/fobFirmware.c ****         uart_buffer_index = 0;
 652              		.loc 1 113 9 is_stmt 1 view .LVU168
 653              	.LVL54:
 115:../../application/src/fobFirmware.c ****         if (!(strcmp((char *)uart_buffer, "enable")))
 654              		.loc 1 115 9 view .LVU169
 115:../../application/src/fobFirmware.c ****         if (!(strcmp((char *)uart_buffer, "enable")))
 655              		.loc 1 115 15 is_stmt 0 view .LVU170
 656 00d4 0E49     		ldr	r1, .L52+16
 657 00d6 01A8     		add	r0, sp, #4
 658              	.LVL55:
 115:../../application/src/fobFirmware.c ****         if (!(strcmp((char *)uart_buffer, "enable")))
 659              		.loc 1 115 15 view .LVU171
 660 00d8 FFF7FEFF 		bl	strcmp
 661              	.LVL56:
 115:../../application/src/fobFirmware.c ****         if (!(strcmp((char *)uart_buffer, "enable")))
 662              		.loc 1 115 12 view .LVU172
 663 00dc 30B1     		cbz	r0, .L50
 119:../../application/src/fobFirmware.c ****         else if (!(strcmp((char *)uart_buffer, "pair")))
 664              		.loc 1 119 14 is_stmt 1 view .LVU173
 119:../../application/src/fobFirmware.c ****         else if (!(strcmp((char *)uart_buffer, "pair")))
 665              		.loc 1 119 20 is_stmt 0 view .LVU174
 666 00de 0D49     		ldr	r1, .L52+20
 667 00e0 01A8     		add	r0, sp, #4
 668 00e2 FFF7FEFF 		bl	strcmp
 669              	.LVL57:
 119:../../application/src/fobFirmware.c ****         else if (!(strcmp((char *)uart_buffer, "pair")))
 670              		.loc 1 119 17 view .LVU175
 671 00e6 30B1     		cbz	r0, .L51
 113:../../application/src/fobFirmware.c ****         uart_buffer_index = 0;
 672              		.loc 1 113 27 view .LVU176
 673 00e8 0024     		movs	r4, #0
 674 00ea 9FE7     		b	.L41
 675              	.L50:
 117:../../application/src/fobFirmware.c ****           enableFeature(&fob_state_ram);
 676              		.loc 1 117 11 is_stmt 1 view .LVU177
 677 00ec 04A8     		add	r0, sp, #16
 678 00ee FFF7FEFF 		bl	enableFeature
 679              	.LVL58:
 113:../../application/src/fobFirmware.c ****         uart_buffer_index = 0;
 680              		.loc 1 113 27 is_stmt 0 view .LVU178
ARM GAS  /tmp/cc3QQpu6.s 			page 19


 681 00f2 0024     		movs	r4, #0
 682 00f4 9AE7     		b	.L41
 683              	.L51:
 121:../../application/src/fobFirmware.c ****           pairFob(&fob_state_ram);
 684              		.loc 1 121 11 is_stmt 1 view .LVU179
 685 00f6 04A8     		add	r0, sp, #16
 686 00f8 FFF7FEFF 		bl	pairFob
 687              	.LVL59:
 113:../../application/src/fobFirmware.c ****         uart_buffer_index = 0;
 688              		.loc 1 113 27 is_stmt 0 view .LVU180
 689 00fc 0024     		movs	r4, #0
 690 00fe 95E7     		b	.L41
 691              	.L53:
 692              		.align	2
 693              	.L52:
 694 0100 00000000 		.word	.LC3
 695 0104 0C000000 		.word	.LC4
 696 0108 14000000 		.word	.LC5
 697 010c 1C000000 		.word	.LC6
 698 0110 24000000 		.word	.LC7
 699 0114 2C000000 		.word	.LC8
 700              	.LBE7:
 701              		.cfi_endproc
 702              	.LFE0:
 704              		.text
 705              	.Letext0:
 706              		.file 2 "/usr/lib/gcc/arm-none-eabi/10.3.1/include/stdint.h"
 707              		.file 3 "../../application/inc/messages.h"
 708              		.file 4 "../../application/inc/dataFormats.h"
 709              		.file 5 "../../application/inc/uart.h"
 710              		.file 6 "/usr/include/newlib/string.h"
 711              		.file 7 "../../application/inc/platform.h"
ARM GAS  /tmp/cc3QQpu6.s 			page 20


DEFINED SYMBOLS
                            *ABS*:0000000000000000 fobFirmware.c
     /tmp/cc3QQpu6.s:18     .rodata.pairFob.str1.4:0000000000000000 $d
     /tmp/cc3QQpu6.s:25     .text.pairFob:0000000000000000 $t
     /tmp/cc3QQpu6.s:33     .text.pairFob:0000000000000000 pairFob
     /tmp/cc3QQpu6.s:157    .text.pairFob:0000000000000074 $d
     /tmp/cc3QQpu6.s:163    .rodata.enableFeature.str1.4:0000000000000000 $d
     /tmp/cc3QQpu6.s:167    .text.enableFeature:0000000000000000 $t
     /tmp/cc3QQpu6.s:174    .text.enableFeature:0000000000000000 enableFeature
     /tmp/cc3QQpu6.s:286    .text.enableFeature:0000000000000064 $d
     /tmp/cc3QQpu6.s:291    .text.unlockCar:0000000000000000 $t
     /tmp/cc3QQpu6.s:298    .text.unlockCar:0000000000000000 unlockCar
     /tmp/cc3QQpu6.s:354    .text.startCar:0000000000000000 $t
     /tmp/cc3QQpu6.s:361    .text.startCar:0000000000000000 startCar
     /tmp/cc3QQpu6.s:417    .text.receiveAck:0000000000000000 $t
     /tmp/cc3QQpu6.s:424    .text.receiveAck:0000000000000000 receiveAck
     /tmp/cc3QQpu6.s:460    .rodata.main.str1.4:0000000000000000 $d
     /tmp/cc3QQpu6.s:479    .text.main:0000000000000000 $t
     /tmp/cc3QQpu6.s:486    .text.main:0000000000000000 main
     /tmp/cc3QQpu6.s:694    .text.main:0000000000000100 $d

UNDEFINED SYMBOLS
uart_write
uart_readline
strcmp
send_board_message
receive_board_message_by_type
strcpy
saveFobState
initHardware_fob
readVar
uart_avail
buttonPressed
uart_readb
