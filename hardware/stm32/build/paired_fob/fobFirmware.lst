ARM GAS  /tmp/ccMdSqK2.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"fobFirmware.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.rodata.pairFob.str1.4,"aMS",%progbits,1
  18              		.align	2
  19              	.LC0:
  20 0000 5000     		.ascii	"P\000"
  21 0002 0000     		.align	2
  22              	.LC1:
  23 0004 50616972 		.ascii	"Paired\000"
  23      656400
  24              		.section	.text.pairFob,"ax",%progbits
  25              		.align	1
  26              		.global	pairFob
  27              		.arch armv7e-m
  28              		.syntax unified
  29              		.thumb
  30              		.thumb_func
  31              		.fpu fpv4-sp-d16
  33              	pairFob:
  34              	.LVL0:
  35              	.LFB1:
  36              		.file 1 "../../application/src/fobFirmware.c"
   1:../../application/src/fobFirmware.c **** /**
   2:../../application/src/fobFirmware.c ****  * @file main.c
   3:../../application/src/fobFirmware.c ****  * @author Frederich Stine
   4:../../application/src/fobFirmware.c ****  * @brief eCTF Fob Example Design Implementation
   5:../../application/src/fobFirmware.c ****  * @date 2023
   6:../../application/src/fobFirmware.c ****  *
   7:../../application/src/fobFirmware.c ****  * This source file is part of an example system for MITRE's 2023 Embedded
   8:../../application/src/fobFirmware.c ****  * System CTF (eCTF). This code is being provided only for educational purposes
   9:../../application/src/fobFirmware.c ****  * for the 2023 MITRE eCTF competition, and may not meet MITRE standards for
  10:../../application/src/fobFirmware.c ****  * quality. Use this code at your own risk!
  11:../../application/src/fobFirmware.c ****  *
  12:../../application/src/fobFirmware.c ****  * @copyright Copyright (c) 2023 The MITRE Corporation
  13:../../application/src/fobFirmware.c ****  */
  14:../../application/src/fobFirmware.c **** 
  15:../../application/src/fobFirmware.c **** #include <stdbool.h>
  16:../../application/src/fobFirmware.c **** #include <stdint.h>
  17:../../application/src/fobFirmware.c **** #include <string.h>
  18:../../application/src/fobFirmware.c **** 
  19:../../application/src/fobFirmware.c **** #include "secrets.h"
  20:../../application/src/fobFirmware.c **** #include "messages.h"
  21:../../application/src/fobFirmware.c **** #include "dataFormats.h"
ARM GAS  /tmp/ccMdSqK2.s 			page 2


  22:../../application/src/fobFirmware.c **** #include "uart.h"
  23:../../application/src/fobFirmware.c **** #include "platform.h"
  24:../../application/src/fobFirmware.c **** 
  25:../../application/src/fobFirmware.c **** #define FLASH_PAIRED 0x00
  26:../../application/src/fobFirmware.c **** #define FLASH_UNPAIRED 0xFF
  27:../../application/src/fobFirmware.c **** 
  28:../../application/src/fobFirmware.c **** /*** Structure definitions ***/
  29:../../application/src/fobFirmware.c **** // Defines a struct for the format of an enable message
  30:../../application/src/fobFirmware.c **** typedef struct
  31:../../application/src/fobFirmware.c **** {
  32:../../application/src/fobFirmware.c ****   uint8_t car_id[8];
  33:../../application/src/fobFirmware.c ****   uint8_t feature;
  34:../../application/src/fobFirmware.c **** } ENABLE_PACKET;
  35:../../application/src/fobFirmware.c **** 
  36:../../application/src/fobFirmware.c **** /*** Function definitions ***/
  37:../../application/src/fobFirmware.c **** // Core functions - all functionality supported by fob
  38:../../application/src/fobFirmware.c **** void pairFob(FLASH_DATA *fob_state_ram);
  39:../../application/src/fobFirmware.c **** void unlockCar(FLASH_DATA *fob_state_ram);
  40:../../application/src/fobFirmware.c **** void enableFeature(FLASH_DATA *fob_state_ram);
  41:../../application/src/fobFirmware.c **** void startCar(FLASH_DATA *fob_state_ram);
  42:../../application/src/fobFirmware.c **** 
  43:../../application/src/fobFirmware.c **** // Helper functions - receive ack message
  44:../../application/src/fobFirmware.c **** uint8_t receiveAck();
  45:../../application/src/fobFirmware.c **** 
  46:../../application/src/fobFirmware.c **** /**
  47:../../application/src/fobFirmware.c ****  * @brief Main function for the fob example
  48:../../application/src/fobFirmware.c ****  *
  49:../../application/src/fobFirmware.c ****  * Listens over UART and SW1 for an unlock command. If unlock command presented,
  50:../../application/src/fobFirmware.c ****  * attempts to unlock door. Listens over UART for pair command. If pair
  51:../../application/src/fobFirmware.c ****  * command presented, attempts to either pair a new key, or be paired
  52:../../application/src/fobFirmware.c ****  * based on firmware build.
  53:../../application/src/fobFirmware.c ****  */
  54:../../application/src/fobFirmware.c **** int main(int argc, char ** argv)
  55:../../application/src/fobFirmware.c **** {
  56:../../application/src/fobFirmware.c ****   initHardware_fob(argc, argv);
  57:../../application/src/fobFirmware.c **** 
  58:../../application/src/fobFirmware.c ****   FLASH_DATA fob_state_ram;
  59:../../application/src/fobFirmware.c ****   FLASH_DATA fob_state_flash;
  60:../../application/src/fobFirmware.c ****   readVar((uint8_t*)(&fob_state_flash), "fob_state");
  61:../../application/src/fobFirmware.c **** 
  62:../../application/src/fobFirmware.c **** // If paired fob, initialize the system information
  63:../../application/src/fobFirmware.c **** #if PAIRED == 1
  64:../../application/src/fobFirmware.c ****   if (fob_state_flash.paired == FLASH_UNPAIRED)
  65:../../application/src/fobFirmware.c ****   {
  66:../../application/src/fobFirmware.c ****     strcpy((char *)(fob_state_ram.pair_info.password), PASSWORD);
  67:../../application/src/fobFirmware.c ****     strcpy((char *)(fob_state_ram.pair_info.pin), PAIR_PIN);
  68:../../application/src/fobFirmware.c ****     strcpy((char *)(fob_state_ram.pair_info.car_id), CAR_ID);
  69:../../application/src/fobFirmware.c ****     strcpy((char *)(fob_state_ram.feature_info.car_id), CAR_ID);
  70:../../application/src/fobFirmware.c ****     fob_state_ram.paired = FLASH_PAIRED;
  71:../../application/src/fobFirmware.c **** 
  72:../../application/src/fobFirmware.c ****     //saveFobState(&fob_state_ram);
  73:../../application/src/fobFirmware.c ****   }
  74:../../application/src/fobFirmware.c **** #else
  75:../../application/src/fobFirmware.c ****   fob_state_ram.paired = FLASH_UNPAIRED;
  76:../../application/src/fobFirmware.c **** #endif
  77:../../application/src/fobFirmware.c **** 
  78:../../application/src/fobFirmware.c ****   char msg[] = "Here\n";
ARM GAS  /tmp/ccMdSqK2.s 			page 3


  79:../../application/src/fobFirmware.c ****   uart_write(HOST_UART, (uint8_t*)msg, strlen(msg));
  80:../../application/src/fobFirmware.c **** 
  81:../../application/src/fobFirmware.c ****   if (fob_state_flash.paired == FLASH_PAIRED)
  82:../../application/src/fobFirmware.c ****   {
  83:../../application/src/fobFirmware.c ****     memcpy(&fob_state_ram, &fob_state_flash, sizeof(FLASH_DATA));
  84:../../application/src/fobFirmware.c ****   }
  85:../../application/src/fobFirmware.c **** 
  86:../../application/src/fobFirmware.c ****   // This will run on first boot to initialize features
  87:../../application/src/fobFirmware.c ****   if (fob_state_ram.feature_info.num_active == 0xFF)
  88:../../application/src/fobFirmware.c ****   {
  89:../../application/src/fobFirmware.c ****     fob_state_ram.feature_info.num_active = 0;
  90:../../application/src/fobFirmware.c ****     saveFobState(&fob_state_ram);
  91:../../application/src/fobFirmware.c ****   }
  92:../../application/src/fobFirmware.c **** 
  93:../../application/src/fobFirmware.c ****   char msg2[] = "Fob state loaded. Current fob state: \n";
  94:../../application/src/fobFirmware.c ****   uart_write(HOST_UART, (uint8_t*)msg2, strlen(msg2));
  95:../../application/src/fobFirmware.c ****   uart_write(HOST_UART, (uint8_t*)(&fob_state_ram), sizeof(FLASH_DATA));
  96:../../application/src/fobFirmware.c **** 
  97:../../application/src/fobFirmware.c ****   // Declare a buffer for reading and writing to UART
  98:../../application/src/fobFirmware.c ****   uint8_t uart_buffer[10];
  99:../../application/src/fobFirmware.c ****   uint8_t uart_buffer_index = 0;
 100:../../application/src/fobFirmware.c **** 
 101:../../application/src/fobFirmware.c ****   // Infinite loop for polling UART
 102:../../application/src/fobFirmware.c ****   while (true)
 103:../../application/src/fobFirmware.c ****   {
 104:../../application/src/fobFirmware.c **** 
 105:../../application/src/fobFirmware.c ****     // Non blocking UART polling
 106:../../application/src/fobFirmware.c ****     if (uart_avail(HOST_UART))
 107:../../application/src/fobFirmware.c ****     {
 108:../../application/src/fobFirmware.c ****       uint8_t uart_char = (uint8_t)uart_readb(HOST_UART);
 109:../../application/src/fobFirmware.c **** 
 110:../../application/src/fobFirmware.c ****       if ((uart_char != '\r') && (uart_char != '\n') && (uart_char != '\0') &&
 111:../../application/src/fobFirmware.c ****           (uart_char != 0xD))
 112:../../application/src/fobFirmware.c ****       {
 113:../../application/src/fobFirmware.c ****         uart_buffer[uart_buffer_index] = uart_char;
 114:../../application/src/fobFirmware.c ****         uart_buffer_index++;
 115:../../application/src/fobFirmware.c ****       }
 116:../../application/src/fobFirmware.c ****       else
 117:../../application/src/fobFirmware.c ****       {
 118:../../application/src/fobFirmware.c ****         uart_buffer[uart_buffer_index] = 0x00;
 119:../../application/src/fobFirmware.c ****         uart_buffer_index = 0;
 120:../../application/src/fobFirmware.c **** 
 121:../../application/src/fobFirmware.c ****         if (!(strcmp((char *)uart_buffer, "enable")))
 122:../../application/src/fobFirmware.c ****         {
 123:../../application/src/fobFirmware.c ****           enableFeature(&fob_state_ram);
 124:../../application/src/fobFirmware.c ****         }
 125:../../application/src/fobFirmware.c ****         else if (!(strcmp((char *)uart_buffer, "pair")))
 126:../../application/src/fobFirmware.c ****         {
 127:../../application/src/fobFirmware.c ****           pairFob(&fob_state_ram);
 128:../../application/src/fobFirmware.c ****         }
 129:../../application/src/fobFirmware.c ****       }
 130:../../application/src/fobFirmware.c ****     }
 131:../../application/src/fobFirmware.c **** 
 132:../../application/src/fobFirmware.c ****     if(buttonPressed())
 133:../../application/src/fobFirmware.c ****     {
 134:../../application/src/fobFirmware.c ****       char msg[] = "Button press detected\n";
 135:../../application/src/fobFirmware.c ****       uart_write(HOST_UART, (uint8_t*)msg, strlen(msg));
ARM GAS  /tmp/ccMdSqK2.s 			page 4


 136:../../application/src/fobFirmware.c ****       unlockCar(&fob_state_ram);
 137:../../application/src/fobFirmware.c ****       if (receiveAck())
 138:../../application/src/fobFirmware.c ****       {
 139:../../application/src/fobFirmware.c ****         startCar(&fob_state_ram);
 140:../../application/src/fobFirmware.c ****       }
 141:../../application/src/fobFirmware.c ****     }
 142:../../application/src/fobFirmware.c ****   }
 143:../../application/src/fobFirmware.c **** }
 144:../../application/src/fobFirmware.c **** 
 145:../../application/src/fobFirmware.c **** /**
 146:../../application/src/fobFirmware.c ****  * @brief Function that carries out pairing of the fob
 147:../../application/src/fobFirmware.c ****  *
 148:../../application/src/fobFirmware.c ****  * @param fob_state_ram pointer to the current fob state in ram
 149:../../application/src/fobFirmware.c ****  */
 150:../../application/src/fobFirmware.c **** void pairFob(FLASH_DATA *fob_state_ram)
 151:../../application/src/fobFirmware.c **** {
  37              		.loc 1 151 1 view -0
  38              		.cfi_startproc
  39              		@ args = 0, pretend = 0, frame = 16
  40              		@ frame_needed = 0, uses_anonymous_args = 0
  41              		.loc 1 151 1 is_stmt 0 view .LVU1
  42 0000 70B5     		push	{r4, r5, r6, lr}
  43              	.LCFI0:
  44              		.cfi_def_cfa_offset 16
  45              		.cfi_offset 4, -16
  46              		.cfi_offset 5, -12
  47              		.cfi_offset 6, -8
  48              		.cfi_offset 14, -4
  49 0002 84B0     		sub	sp, sp, #16
  50              	.LCFI1:
  51              		.cfi_def_cfa_offset 32
  52 0004 0446     		mov	r4, r0
 152:../../application/src/fobFirmware.c ****   MESSAGE_PACKET message;
  53              		.loc 1 152 3 is_stmt 1 view .LVU2
 153:../../application/src/fobFirmware.c ****   // Start pairing transaction - fob is already paired
 154:../../application/src/fobFirmware.c ****   if (fob_state_ram->paired == FLASH_PAIRED)
  54              		.loc 1 154 3 view .LVU3
  55              		.loc 1 154 20 is_stmt 0 view .LVU4
  56 0006 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
  57              		.loc 1 154 6 view .LVU5
  58 0008 EBB9     		cbnz	r3, .L2
  59              	.LBB2:
 155:../../application/src/fobFirmware.c ****   {
 156:../../application/src/fobFirmware.c ****     int16_t bytes_read;
  60              		.loc 1 156 5 is_stmt 1 view .LVU6
 157:../../application/src/fobFirmware.c ****     uint8_t uart_buffer[8];
  61              		.loc 1 157 5 view .LVU7
 158:../../application/src/fobFirmware.c ****     uart_write(HOST_UART, (uint8_t *)"P", 1);
  62              		.loc 1 158 5 view .LVU8
  63 000a 0122     		movs	r2, #1
  64 000c 1949     		ldr	r1, .L6
  65 000e 0020     		movs	r0, #0
  66              	.LVL1:
  67              		.loc 1 158 5 is_stmt 0 view .LVU9
  68 0010 FFF7FEFF 		bl	uart_write
  69              	.LVL2:
 159:../../application/src/fobFirmware.c ****     bytes_read = uart_readline(HOST_UART, uart_buffer);
ARM GAS  /tmp/ccMdSqK2.s 			page 5


  70              		.loc 1 159 5 is_stmt 1 view .LVU10
  71              		.loc 1 159 18 is_stmt 0 view .LVU11
  72 0014 6946     		mov	r1, sp
  73 0016 0020     		movs	r0, #0
  74 0018 FFF7FEFF 		bl	uart_readline
  75              	.LVL3:
  76              		.loc 1 159 16 view .LVU12
  77 001c 00B2     		sxth	r0, r0
  78              	.LVL4:
 160:../../application/src/fobFirmware.c **** 
 161:../../application/src/fobFirmware.c ****     if (bytes_read == 6)
  79              		.loc 1 161 5 is_stmt 1 view .LVU13
  80              		.loc 1 161 8 is_stmt 0 view .LVU14
  81 001e 0628     		cmp	r0, #6
  82 0020 26D1     		bne	.L1
 162:../../application/src/fobFirmware.c ****     {
 163:../../application/src/fobFirmware.c ****       // If the pin is correct
 164:../../application/src/fobFirmware.c ****       if (!(strcmp((char *)uart_buffer,
  83              		.loc 1 164 7 is_stmt 1 view .LVU15
  84              		.loc 1 164 13 is_stmt 0 view .LVU16
  85 0022 04F11101 		add	r1, r4, #17
  86 0026 6846     		mov	r0, sp
  87              	.LVL5:
  88              		.loc 1 164 13 view .LVU17
  89 0028 FFF7FEFF 		bl	strcmp
  90              	.LVL6:
  91              		.loc 1 164 10 view .LVU18
  92 002c 00BB     		cbnz	r0, .L1
 165:../../application/src/fobFirmware.c ****                    (char *)fob_state_ram->pair_info.pin)))
 166:../../application/src/fobFirmware.c ****       {
 167:../../application/src/fobFirmware.c ****         // Pair the new key by sending a PAIR_PACKET structure
 168:../../application/src/fobFirmware.c ****         // with required information to unlock door
 169:../../application/src/fobFirmware.c ****         message.message_len = sizeof(PAIR_PACKET);
  93              		.loc 1 169 9 is_stmt 1 view .LVU19
  94              		.loc 1 169 29 is_stmt 0 view .LVU20
  95 002e 1823     		movs	r3, #24
  96 0030 8DF80930 		strb	r3, [sp, #9]
 170:../../application/src/fobFirmware.c ****         message.magic = PAIR_MAGIC;
  97              		.loc 1 170 9 is_stmt 1 view .LVU21
  98              		.loc 1 170 23 is_stmt 0 view .LVU22
  99 0034 5523     		movs	r3, #85
 100 0036 8DF80830 		strb	r3, [sp, #8]
 171:../../application/src/fobFirmware.c ****         message.buffer = (uint8_t *)&fob_state_ram->pair_info;
 101              		.loc 1 171 9 is_stmt 1 view .LVU23
 102              		.loc 1 171 37 is_stmt 0 view .LVU24
 103 003a 0134     		adds	r4, r4, #1
 104              	.LVL7:
 105              		.loc 1 171 24 view .LVU25
 106 003c 0394     		str	r4, [sp, #12]
 172:../../application/src/fobFirmware.c ****         send_board_message(&message);
 107              		.loc 1 172 9 is_stmt 1 view .LVU26
 108 003e 02A8     		add	r0, sp, #8
 109 0040 FFF7FEFF 		bl	send_board_message
 110              	.LVL8:
 111 0044 14E0     		b	.L1
 112              	.LVL9:
 113              	.L2:
ARM GAS  /tmp/ccMdSqK2.s 			page 6


 114              		.loc 1 172 9 is_stmt 0 view .LVU27
 115              	.LBE2:
 173:../../application/src/fobFirmware.c ****       }
 174:../../application/src/fobFirmware.c ****     }
 175:../../application/src/fobFirmware.c ****   }
 176:../../application/src/fobFirmware.c **** 
 177:../../application/src/fobFirmware.c ****   // Start pairing transaction - fob is not paired
 178:../../application/src/fobFirmware.c ****   else
 179:../../application/src/fobFirmware.c ****   {
 180:../../application/src/fobFirmware.c ****     message.buffer = (uint8_t *)&fob_state_ram->pair_info;
 116              		.loc 1 180 5 is_stmt 1 view .LVU28
 117              		.loc 1 180 33 is_stmt 0 view .LVU29
 118 0046 461C     		adds	r6, r0, #1
 119              		.loc 1 180 20 view .LVU30
 120 0048 0396     		str	r6, [sp, #12]
 181:../../application/src/fobFirmware.c ****     receive_board_message_by_type(&message, PAIR_MAGIC);
 121              		.loc 1 181 5 is_stmt 1 view .LVU31
 122 004a 5521     		movs	r1, #85
 123 004c 02A8     		add	r0, sp, #8
 124              	.LVL10:
 125              		.loc 1 181 5 is_stmt 0 view .LVU32
 126 004e FFF7FEFF 		bl	receive_board_message_by_type
 127              	.LVL11:
 182:../../application/src/fobFirmware.c ****     fob_state_ram->paired = FLASH_PAIRED;
 128              		.loc 1 182 5 is_stmt 1 view .LVU33
 129              		.loc 1 182 27 is_stmt 0 view .LVU34
 130 0052 0025     		movs	r5, #0
 131 0054 2046     		mov	r0, r4
 132 0056 00F8195B 		strb	r5, [r0], #25
 183:../../application/src/fobFirmware.c ****     strcpy((char *)fob_state_ram->feature_info.car_id,
 133              		.loc 1 183 5 is_stmt 1 view .LVU35
 134 005a 3146     		mov	r1, r6
 135 005c FFF7FEFF 		bl	strcpy
 136              	.LVL12:
 184:../../application/src/fobFirmware.c ****            (char *)fob_state_ram->pair_info.car_id);
 185:../../application/src/fobFirmware.c **** 
 186:../../application/src/fobFirmware.c ****     uart_write(HOST_UART, (uint8_t *)"Paired", 6);
 137              		.loc 1 186 5 view .LVU36
 138 0060 0622     		movs	r2, #6
 139 0062 0549     		ldr	r1, .L6+4
 140 0064 2846     		mov	r0, r5
 141 0066 FFF7FEFF 		bl	uart_write
 142              	.LVL13:
 187:../../application/src/fobFirmware.c **** 
 188:../../application/src/fobFirmware.c ****     saveFobState(fob_state_ram);
 143              		.loc 1 188 5 view .LVU37
 144 006a 2046     		mov	r0, r4
 145 006c FFF7FEFF 		bl	saveFobState
 146              	.LVL14:
 147              	.L1:
 189:../../application/src/fobFirmware.c ****   }
 190:../../application/src/fobFirmware.c **** }
 148              		.loc 1 190 1 is_stmt 0 view .LVU38
 149 0070 04B0     		add	sp, sp, #16
 150              	.LCFI2:
 151              		.cfi_def_cfa_offset 16
 152              		@ sp needed
ARM GAS  /tmp/ccMdSqK2.s 			page 7


 153 0072 70BD     		pop	{r4, r5, r6, pc}
 154              	.L7:
 155              		.align	2
 156              	.L6:
 157 0074 00000000 		.word	.LC0
 158 0078 04000000 		.word	.LC1
 159              		.cfi_endproc
 160              	.LFE1:
 162              		.section	.rodata.enableFeature.str1.4,"aMS",%progbits,1
 163              		.align	2
 164              	.LC2:
 165 0000 456E6162 		.ascii	"Enabled\000"
 165      6C656400 
 166              		.section	.text.enableFeature,"ax",%progbits
 167              		.align	1
 168              		.global	enableFeature
 169              		.syntax unified
 170              		.thumb
 171              		.thumb_func
 172              		.fpu fpv4-sp-d16
 174              	enableFeature:
 175              	.LVL15:
 176              	.LFB2:
 191:../../application/src/fobFirmware.c **** 
 192:../../application/src/fobFirmware.c **** /**
 193:../../application/src/fobFirmware.c ****  * @brief Function that handles enabling a new feature on the fob
 194:../../application/src/fobFirmware.c ****  *
 195:../../application/src/fobFirmware.c ****  * @param fob_state_ram pointer to the current fob state in ram
 196:../../application/src/fobFirmware.c ****  */
 197:../../application/src/fobFirmware.c **** void enableFeature(FLASH_DATA *fob_state_ram)
 198:../../application/src/fobFirmware.c **** {
 177              		.loc 1 198 1 is_stmt 1 view -0
 178              		.cfi_startproc
 179              		@ args = 0, pretend = 0, frame = 24
 180              		@ frame_needed = 0, uses_anonymous_args = 0
 199:../../application/src/fobFirmware.c ****   if (fob_state_ram->paired == FLASH_PAIRED)
 181              		.loc 1 199 3 view .LVU40
 182              		.loc 1 199 20 is_stmt 0 view .LVU41
 183 0000 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
 184              		.loc 1 199 6 view .LVU42
 185 0002 03B1     		cbz	r3, .L17
 186 0004 7047     		bx	lr
 187              	.L17:
 198:../../application/src/fobFirmware.c ****   if (fob_state_ram->paired == FLASH_PAIRED)
 188              		.loc 1 198 1 view .LVU43
 189 0006 10B5     		push	{r4, lr}
 190              	.LCFI3:
 191              		.cfi_def_cfa_offset 8
 192              		.cfi_offset 4, -8
 193              		.cfi_offset 14, -4
 194 0008 86B0     		sub	sp, sp, #24
 195              	.LCFI4:
 196              		.cfi_def_cfa_offset 32
 197 000a 0446     		mov	r4, r0
 198              	.LBB3:
 200:../../application/src/fobFirmware.c ****   {
 201:../../application/src/fobFirmware.c ****     uint8_t uart_buffer[20];
ARM GAS  /tmp/ccMdSqK2.s 			page 8


 199              		.loc 1 201 5 is_stmt 1 view .LVU44
 202:../../application/src/fobFirmware.c ****     uart_readline(HOST_UART, uart_buffer);
 200              		.loc 1 202 5 view .LVU45
 201 000c 01A9     		add	r1, sp, #4
 202 000e 0020     		movs	r0, #0
 203              	.LVL16:
 204              		.loc 1 202 5 is_stmt 0 view .LVU46
 205 0010 FFF7FEFF 		bl	uart_readline
 206              	.LVL17:
 203:../../application/src/fobFirmware.c **** 
 204:../../application/src/fobFirmware.c ****     ENABLE_PACKET *enable_message = (ENABLE_PACKET *)uart_buffer;
 207              		.loc 1 204 5 is_stmt 1 view .LVU47
 205:../../application/src/fobFirmware.c ****     if (strcmp((char *)fob_state_ram->pair_info.car_id,
 208              		.loc 1 205 5 view .LVU48
 209              		.loc 1 205 9 is_stmt 0 view .LVU49
 210 0014 01A9     		add	r1, sp, #4
 211              	.LVL18:
 212              		.loc 1 205 9 view .LVU50
 213 0016 601C     		adds	r0, r4, #1
 214 0018 FFF7FEFF 		bl	strcmp
 215              	.LVL19:
 216              		.loc 1 205 8 view .LVU51
 217 001c 0346     		mov	r3, r0
 218 001e F0B9     		cbnz	r0, .L8
 206:../../application/src/fobFirmware.c ****                (char *)enable_message->car_id))
 207:../../application/src/fobFirmware.c ****     {
 208:../../application/src/fobFirmware.c ****       return;
 209:../../application/src/fobFirmware.c ****     }
 210:../../application/src/fobFirmware.c **** 
 211:../../application/src/fobFirmware.c ****     // Feature list full
 212:../../application/src/fobFirmware.c ****     if (fob_state_ram->feature_info.num_active == NUM_FEATURES)
 219              		.loc 1 212 5 is_stmt 1 view .LVU52
 220              		.loc 1 212 36 is_stmt 0 view .LVU53
 221 0020 94F82100 		ldrb	r0, [r4, #33]	@ zero_extendqisi2
 222              		.loc 1 212 8 view .LVU54
 223 0024 0328     		cmp	r0, #3
 224 0026 1AD0     		beq	.L8
 225              	.L11:
 226              	.LVL20:
 227              	.LBB4:
 213:../../application/src/fobFirmware.c ****     {
 214:../../application/src/fobFirmware.c ****       return;
 215:../../application/src/fobFirmware.c ****     }
 216:../../application/src/fobFirmware.c **** 
 217:../../application/src/fobFirmware.c ****     // Search for feature in list
 218:../../application/src/fobFirmware.c ****     for (int i = 0; i < fob_state_ram->feature_info.num_active; i++)
 228              		.loc 1 218 21 is_stmt 1 discriminator 1 view .LVU55
 229              		.loc 1 218 5 is_stmt 0 discriminator 1 view .LVU56
 230 0028 9842     		cmp	r0, r3
 231 002a 08DD     		ble	.L18
 219:../../application/src/fobFirmware.c ****     {
 220:../../application/src/fobFirmware.c ****       if (fob_state_ram->feature_info.features[i] == enable_message->feature)
 232              		.loc 1 220 7 is_stmt 1 view .LVU57
 233              		.loc 1 220 47 is_stmt 0 view .LVU58
 234 002c E218     		adds	r2, r4, r3
 235 002e 92F82210 		ldrb	r1, [r2, #34]	@ zero_extendqisi2
 236              		.loc 1 220 68 view .LVU59
ARM GAS  /tmp/ccMdSqK2.s 			page 9


 237 0032 9DF80C20 		ldrb	r2, [sp, #12]	@ zero_extendqisi2
 238              		.loc 1 220 10 view .LVU60
 239 0036 9142     		cmp	r1, r2
 240 0038 11D0     		beq	.L8
 218:../../application/src/fobFirmware.c ****     {
 241              		.loc 1 218 65 is_stmt 1 discriminator 2 view .LVU61
 218:../../application/src/fobFirmware.c ****     {
 242              		.loc 1 218 66 is_stmt 0 discriminator 2 view .LVU62
 243 003a 0133     		adds	r3, r3, #1
 244              	.LVL21:
 218:../../application/src/fobFirmware.c ****     {
 245              		.loc 1 218 66 discriminator 2 view .LVU63
 246 003c F4E7     		b	.L11
 247              	.L18:
 218:../../application/src/fobFirmware.c ****     {
 248              		.loc 1 218 66 discriminator 2 view .LVU64
 249              	.LBE4:
 221:../../application/src/fobFirmware.c ****       {
 222:../../application/src/fobFirmware.c ****         return;
 223:../../application/src/fobFirmware.c ****       }
 224:../../application/src/fobFirmware.c ****     }
 225:../../application/src/fobFirmware.c **** 
 226:../../application/src/fobFirmware.c ****     fob_state_ram->feature_info
 250              		.loc 1 226 5 is_stmt 1 view .LVU65
 227:../../application/src/fobFirmware.c ****         .features[fob_state_ram->feature_info.num_active] =
 228:../../application/src/fobFirmware.c ****         enable_message->feature;
 251              		.loc 1 228 23 is_stmt 0 view .LVU66
 252 003e 9DF80C20 		ldrb	r2, [sp, #12]	@ zero_extendqisi2
 227:../../application/src/fobFirmware.c ****         .features[fob_state_ram->feature_info.num_active] =
 253              		.loc 1 227 59 view .LVU67
 254 0042 2318     		adds	r3, r4, r0
 255              	.LVL22:
 227:../../application/src/fobFirmware.c ****         .features[fob_state_ram->feature_info.num_active] =
 256              		.loc 1 227 59 view .LVU68
 257 0044 83F82220 		strb	r2, [r3, #34]
 229:../../application/src/fobFirmware.c ****     fob_state_ram->feature_info.num_active++;
 258              		.loc 1 229 5 is_stmt 1 view .LVU69
 259              		.loc 1 229 43 is_stmt 0 view .LVU70
 260 0048 0130     		adds	r0, r0, #1
 261 004a 84F82100 		strb	r0, [r4, #33]
 230:../../application/src/fobFirmware.c **** 
 231:../../application/src/fobFirmware.c ****     saveFobState(fob_state_ram);
 262              		.loc 1 231 5 is_stmt 1 view .LVU71
 263 004e 2046     		mov	r0, r4
 264 0050 FFF7FEFF 		bl	saveFobState
 265              	.LVL23:
 232:../../application/src/fobFirmware.c ****     uart_write(HOST_UART, (uint8_t *)"Enabled", 7);
 266              		.loc 1 232 5 view .LVU72
 267 0054 0722     		movs	r2, #7
 268 0056 0349     		ldr	r1, .L19
 269 0058 0020     		movs	r0, #0
 270 005a FFF7FEFF 		bl	uart_write
 271              	.LVL24:
 272              	.L8:
 273              		.loc 1 232 5 is_stmt 0 view .LVU73
 274              	.LBE3:
 233:../../application/src/fobFirmware.c ****   }
ARM GAS  /tmp/ccMdSqK2.s 			page 10


 234:../../application/src/fobFirmware.c **** }
 275              		.loc 1 234 1 view .LVU74
 276 005e 06B0     		add	sp, sp, #24
 277              	.LCFI5:
 278              		.cfi_def_cfa_offset 8
 279              		@ sp needed
 280 0060 10BD     		pop	{r4, pc}
 281              	.LVL25:
 282              	.L20:
 283              		.loc 1 234 1 view .LVU75
 284 0062 00BF     		.align	2
 285              	.L19:
 286 0064 00000000 		.word	.LC2
 287              		.cfi_endproc
 288              	.LFE2:
 290              		.section	.text.unlockCar,"ax",%progbits
 291              		.align	1
 292              		.global	unlockCar
 293              		.syntax unified
 294              		.thumb
 295              		.thumb_func
 296              		.fpu fpv4-sp-d16
 298              	unlockCar:
 299              	.LVL26:
 300              	.LFB3:
 235:../../application/src/fobFirmware.c **** 
 236:../../application/src/fobFirmware.c **** /**
 237:../../application/src/fobFirmware.c ****  * @brief Function that handles the fob unlocking a car
 238:../../application/src/fobFirmware.c ****  *
 239:../../application/src/fobFirmware.c ****  * @param fob_state_ram pointer to the current fob state in ram
 240:../../application/src/fobFirmware.c ****  */
 241:../../application/src/fobFirmware.c **** void unlockCar(FLASH_DATA *fob_state_ram)
 242:../../application/src/fobFirmware.c **** {
 301              		.loc 1 242 1 is_stmt 1 view -0
 302              		.cfi_startproc
 303              		@ args = 0, pretend = 0, frame = 8
 304              		@ frame_needed = 0, uses_anonymous_args = 0
 243:../../application/src/fobFirmware.c ****   if (fob_state_ram->paired == FLASH_PAIRED)
 305              		.loc 1 243 3 view .LVU77
 306              		.loc 1 243 20 is_stmt 0 view .LVU78
 307 0000 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
 308              		.loc 1 243 6 view .LVU79
 309 0002 03B1     		cbz	r3, .L27
 310 0004 7047     		bx	lr
 311              	.L27:
 242:../../application/src/fobFirmware.c ****   if (fob_state_ram->paired == FLASH_PAIRED)
 312              		.loc 1 242 1 view .LVU80
 313 0006 00B5     		push	{lr}
 314              	.LCFI6:
 315              		.cfi_def_cfa_offset 4
 316              		.cfi_offset 14, -4
 317 0008 83B0     		sub	sp, sp, #12
 318              	.LCFI7:
 319              		.cfi_def_cfa_offset 16
 320              	.LBB5:
 244:../../application/src/fobFirmware.c ****   {
 245:../../application/src/fobFirmware.c ****     MESSAGE_PACKET message;
ARM GAS  /tmp/ccMdSqK2.s 			page 11


 321              		.loc 1 245 5 is_stmt 1 view .LVU81
 246:../../application/src/fobFirmware.c ****     message.message_len = 6;
 322              		.loc 1 246 5 view .LVU82
 323              		.loc 1 246 25 is_stmt 0 view .LVU83
 324 000a 0623     		movs	r3, #6
 325 000c 8DF80130 		strb	r3, [sp, #1]
 247:../../application/src/fobFirmware.c ****     message.magic = UNLOCK_MAGIC;
 326              		.loc 1 247 5 is_stmt 1 view .LVU84
 327              		.loc 1 247 19 is_stmt 0 view .LVU85
 328 0010 5623     		movs	r3, #86
 329 0012 8DF80030 		strb	r3, [sp]
 248:../../application/src/fobFirmware.c ****     message.buffer = fob_state_ram->pair_info.password;
 330              		.loc 1 248 5 is_stmt 1 view .LVU86
 331              		.loc 1 248 22 is_stmt 0 view .LVU87
 332 0016 0930     		adds	r0, r0, #9
 333              	.LVL27:
 334              		.loc 1 248 20 view .LVU88
 335 0018 0190     		str	r0, [sp, #4]
 249:../../application/src/fobFirmware.c ****     send_board_message(&message);
 336              		.loc 1 249 5 is_stmt 1 view .LVU89
 337 001a 6846     		mov	r0, sp
 338              	.LVL28:
 339              		.loc 1 249 5 is_stmt 0 view .LVU90
 340 001c FFF7FEFF 		bl	send_board_message
 341              	.LVL29:
 342              		.loc 1 249 5 view .LVU91
 343              	.LBE5:
 250:../../application/src/fobFirmware.c ****   }
 251:../../application/src/fobFirmware.c **** }
 344              		.loc 1 251 1 view .LVU92
 345 0020 03B0     		add	sp, sp, #12
 346              	.LCFI8:
 347              		.cfi_def_cfa_offset 4
 348              		@ sp needed
 349 0022 5DF804FB 		ldr	pc, [sp], #4
 350              		.cfi_endproc
 351              	.LFE3:
 353              		.section	.text.startCar,"ax",%progbits
 354              		.align	1
 355              		.global	startCar
 356              		.syntax unified
 357              		.thumb
 358              		.thumb_func
 359              		.fpu fpv4-sp-d16
 361              	startCar:
 362              	.LVL30:
 363              	.LFB4:
 252:../../application/src/fobFirmware.c **** 
 253:../../application/src/fobFirmware.c **** /**
 254:../../application/src/fobFirmware.c ****  * @brief Function that handles the fob starting a car
 255:../../application/src/fobFirmware.c ****  *
 256:../../application/src/fobFirmware.c ****  * @param fob_state_ram pointer to the current fob state in ram
 257:../../application/src/fobFirmware.c ****  */
 258:../../application/src/fobFirmware.c **** void startCar(FLASH_DATA *fob_state_ram)
 259:../../application/src/fobFirmware.c **** {
 364              		.loc 1 259 1 is_stmt 1 view -0
 365              		.cfi_startproc
ARM GAS  /tmp/ccMdSqK2.s 			page 12


 366              		@ args = 0, pretend = 0, frame = 8
 367              		@ frame_needed = 0, uses_anonymous_args = 0
 260:../../application/src/fobFirmware.c ****   if (fob_state_ram->paired == FLASH_PAIRED)
 368              		.loc 1 260 3 view .LVU94
 369              		.loc 1 260 20 is_stmt 0 view .LVU95
 370 0000 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
 371              		.loc 1 260 6 view .LVU96
 372 0002 03B1     		cbz	r3, .L34
 373 0004 7047     		bx	lr
 374              	.L34:
 259:../../application/src/fobFirmware.c ****   if (fob_state_ram->paired == FLASH_PAIRED)
 375              		.loc 1 259 1 view .LVU97
 376 0006 00B5     		push	{lr}
 377              	.LCFI9:
 378              		.cfi_def_cfa_offset 4
 379              		.cfi_offset 14, -4
 380 0008 83B0     		sub	sp, sp, #12
 381              	.LCFI10:
 382              		.cfi_def_cfa_offset 16
 383              	.LBB6:
 261:../../application/src/fobFirmware.c ****   {
 262:../../application/src/fobFirmware.c ****     MESSAGE_PACKET message;
 384              		.loc 1 262 5 is_stmt 1 view .LVU98
 263:../../application/src/fobFirmware.c ****     message.magic = START_MAGIC;
 385              		.loc 1 263 5 view .LVU99
 386              		.loc 1 263 19 is_stmt 0 view .LVU100
 387 000a 5723     		movs	r3, #87
 388 000c 8DF80030 		strb	r3, [sp]
 264:../../application/src/fobFirmware.c ****     message.message_len = sizeof(FEATURE_DATA);
 389              		.loc 1 264 5 is_stmt 1 view .LVU101
 390              		.loc 1 264 25 is_stmt 0 view .LVU102
 391 0010 0C23     		movs	r3, #12
 392 0012 8DF80130 		strb	r3, [sp, #1]
 265:../../application/src/fobFirmware.c ****     message.buffer = (uint8_t *)&fob_state_ram->feature_info;
 393              		.loc 1 265 5 is_stmt 1 view .LVU103
 394              		.loc 1 265 33 is_stmt 0 view .LVU104
 395 0016 1930     		adds	r0, r0, #25
 396              	.LVL31:
 397              		.loc 1 265 20 view .LVU105
 398 0018 0190     		str	r0, [sp, #4]
 266:../../application/src/fobFirmware.c ****     send_board_message(&message);
 399              		.loc 1 266 5 is_stmt 1 view .LVU106
 400 001a 6846     		mov	r0, sp
 401              	.LVL32:
 402              		.loc 1 266 5 is_stmt 0 view .LVU107
 403 001c FFF7FEFF 		bl	send_board_message
 404              	.LVL33:
 405              		.loc 1 266 5 view .LVU108
 406              	.LBE6:
 267:../../application/src/fobFirmware.c ****   }
 268:../../application/src/fobFirmware.c **** }
 407              		.loc 1 268 1 view .LVU109
 408 0020 03B0     		add	sp, sp, #12
 409              	.LCFI11:
 410              		.cfi_def_cfa_offset 4
 411              		@ sp needed
 412 0022 5DF804FB 		ldr	pc, [sp], #4
ARM GAS  /tmp/ccMdSqK2.s 			page 13


 413              		.cfi_endproc
 414              	.LFE4:
 416              		.section	.text.receiveAck,"ax",%progbits
 417              		.align	1
 418              		.global	receiveAck
 419              		.syntax unified
 420              		.thumb
 421              		.thumb_func
 422              		.fpu fpv4-sp-d16
 424              	receiveAck:
 425              	.LFB5:
 269:../../application/src/fobFirmware.c **** 
 270:../../application/src/fobFirmware.c **** /**
 271:../../application/src/fobFirmware.c ****  * @brief Function that receives an ack and returns whether ack was
 272:../../application/src/fobFirmware.c ****  * success/failure
 273:../../application/src/fobFirmware.c ****  *
 274:../../application/src/fobFirmware.c ****  * @return uint8_t Ack success/failure
 275:../../application/src/fobFirmware.c ****  */
 276:../../application/src/fobFirmware.c **** uint8_t receiveAck()
 277:../../application/src/fobFirmware.c **** {
 426              		.loc 1 277 1 is_stmt 1 view -0
 427              		.cfi_startproc
 428              		@ args = 0, pretend = 0, frame = 264
 429              		@ frame_needed = 0, uses_anonymous_args = 0
 430 0000 00B5     		push	{lr}
 431              	.LCFI12:
 432              		.cfi_def_cfa_offset 4
 433              		.cfi_offset 14, -4
 434 0002 C3B0     		sub	sp, sp, #268
 435              	.LCFI13:
 436              		.cfi_def_cfa_offset 272
 278:../../application/src/fobFirmware.c ****   MESSAGE_PACKET message;
 437              		.loc 1 278 3 view .LVU111
 279:../../application/src/fobFirmware.c ****   uint8_t buffer[255];
 438              		.loc 1 279 3 view .LVU112
 280:../../application/src/fobFirmware.c ****   message.buffer = buffer;
 439              		.loc 1 280 3 view .LVU113
 440              		.loc 1 280 18 is_stmt 0 view .LVU114
 441 0004 CDF804D1 		str	sp, [sp, #260]
 281:../../application/src/fobFirmware.c ****   receive_board_message_by_type(&message, ACK_MAGIC);
 442              		.loc 1 281 3 is_stmt 1 view .LVU115
 443 0008 5421     		movs	r1, #84
 444 000a 40A8     		add	r0, sp, #256
 445 000c FFF7FEFF 		bl	receive_board_message_by_type
 446              	.LVL34:
 282:../../application/src/fobFirmware.c **** 
 283:../../application/src/fobFirmware.c ****   return message.buffer[0];
 447              		.loc 1 283 3 view .LVU116
 284:../../application/src/fobFirmware.c **** }
 448              		.loc 1 284 1 is_stmt 0 view .LVU117
 449 0010 419B     		ldr	r3, [sp, #260]
 450 0012 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
 451 0014 43B0     		add	sp, sp, #268
 452              	.LCFI14:
 453              		.cfi_def_cfa_offset 4
 454              		@ sp needed
 455 0016 5DF804FB 		ldr	pc, [sp], #4
ARM GAS  /tmp/ccMdSqK2.s 			page 14


 456              		.cfi_endproc
 457              	.LFE5:
 459              		.section	.rodata.main.str1.4,"aMS",%progbits,1
 460              		.align	2
 461              	.LC3:
 462 0000 666F625F 		.ascii	"fob_state\000"
 462      73746174 
 462      6500
 463 000a 0000     		.align	2
 464              	.LC4:
 465 000c 756E6C6F 		.ascii	"unlock\000"
 465      636B00
 466 0013 00       		.align	2
 467              	.LC5:
 468 0014 31323334 		.ascii	"123456\000"
 468      353600
 469 001b 00       		.align	2
 470              	.LC6:
 471 001c 31393838 		.ascii	"1988\000"
 471      00
 472 0021 000000   		.align	2
 473              	.LC9:
 474 0024 656E6162 		.ascii	"enable\000"
 474      6C6500
 475 002b 00       		.align	2
 476              	.LC10:
 477 002c 70616972 		.ascii	"pair\000"
 477      00
 478 0031 000000   		.align	2
 479              	.LC7:
 480 0034 48657265 		.ascii	"Here\012\000"
 480      0A00
 481 003a 0000     		.align	2
 482              	.LC8:
 483 003c 466F6220 		.ascii	"Fob state loaded. Current fob state: \012\000"
 483      73746174 
 483      65206C6F 
 483      61646564 
 483      2E204375 
 484 0063 00       		.align	2
 485              	.LC11:
 486 0064 42757474 		.ascii	"Button press detected\012\000"
 486      6F6E2070 
 486      72657373 
 486      20646574 
 486      65637465 
 487              		.section	.text.main,"ax",%progbits
 488              		.align	1
 489              		.global	main
 490              		.syntax unified
 491              		.thumb
 492              		.thumb_func
 493              		.fpu fpv4-sp-d16
 495              	main:
 496              	.LVL35:
 497              	.LFB0:
  55:../../application/src/fobFirmware.c ****   initHardware_fob(argc, argv);
ARM GAS  /tmp/ccMdSqK2.s 			page 15


 498              		.loc 1 55 1 is_stmt 1 view -0
 499              		.cfi_startproc
 500              		@ args = 0, pretend = 0, frame = 168
 501              		@ frame_needed = 0, uses_anonymous_args = 0
  55:../../application/src/fobFirmware.c ****   initHardware_fob(argc, argv);
 502              		.loc 1 55 1 is_stmt 0 view .LVU119
 503 0000 30B5     		push	{r4, r5, lr}
 504              	.LCFI15:
 505              		.cfi_def_cfa_offset 12
 506              		.cfi_offset 4, -12
 507              		.cfi_offset 5, -8
 508              		.cfi_offset 14, -4
 509 0002 ABB0     		sub	sp, sp, #172
 510              	.LCFI16:
 511              		.cfi_def_cfa_offset 184
  56:../../application/src/fobFirmware.c **** 
 512              		.loc 1 56 3 is_stmt 1 view .LVU120
 513 0004 FFF7FEFF 		bl	initHardware_fob
 514              	.LVL36:
  58:../../application/src/fobFirmware.c ****   FLASH_DATA fob_state_flash;
 515              		.loc 1 58 3 view .LVU121
  59:../../application/src/fobFirmware.c ****   readVar((uint8_t*)(&fob_state_flash), "fob_state");
 516              		.loc 1 59 3 view .LVU122
  60:../../application/src/fobFirmware.c **** 
 517              		.loc 1 60 3 view .LVU123
 518 0008 6349     		ldr	r1, .L54
 519 000a 16A8     		add	r0, sp, #88
 520 000c FFF7FEFF 		bl	readVar
 521              	.LVL37:
  64:../../application/src/fobFirmware.c ****   {
 522              		.loc 1 64 3 view .LVU124
  64:../../application/src/fobFirmware.c ****   {
 523              		.loc 1 64 22 is_stmt 0 view .LVU125
 524 0010 9DF85830 		ldrb	r3, [sp, #88]	@ zero_extendqisi2
  64:../../application/src/fobFirmware.c ****   {
 525              		.loc 1 64 6 view .LVU126
 526 0014 FF2B     		cmp	r3, #255
 527 0016 66D0     		beq	.L49
 528              	.L38:
  78:../../application/src/fobFirmware.c ****   uart_write(HOST_UART, (uint8_t*)msg, strlen(msg));
 529              		.loc 1 78 3 is_stmt 1 view .LVU127
  78:../../application/src/fobFirmware.c ****   uart_write(HOST_UART, (uint8_t*)msg, strlen(msg));
 530              		.loc 1 78 8 is_stmt 0 view .LVU128
 531 0018 604B     		ldr	r3, .L54+4
 532 001a 93E80300 		ldm	r3, {r0, r1}
 533 001e 1490     		str	r0, [sp, #80]
 534 0020 ADF85410 		strh	r1, [sp, #84]	@ movhi
  79:../../application/src/fobFirmware.c **** 
 535              		.loc 1 79 3 is_stmt 1 view .LVU129
  79:../../application/src/fobFirmware.c **** 
 536              		.loc 1 79 40 is_stmt 0 view .LVU130
 537 0024 14A8     		add	r0, sp, #80
 538 0026 FFF7FEFF 		bl	strlen
 539              	.LVL38:
 540 002a 0246     		mov	r2, r0
  79:../../application/src/fobFirmware.c **** 
 541              		.loc 1 79 3 view .LVU131
ARM GAS  /tmp/ccMdSqK2.s 			page 16


 542 002c 14A9     		add	r1, sp, #80
 543 002e 0020     		movs	r0, #0
 544 0030 FFF7FEFF 		bl	uart_write
 545              	.LVL39:
  81:../../application/src/fobFirmware.c ****   {
 546              		.loc 1 81 3 is_stmt 1 view .LVU132
  81:../../application/src/fobFirmware.c ****   {
 547              		.loc 1 81 22 is_stmt 0 view .LVU133
 548 0034 9DF85830 		ldrb	r3, [sp, #88]	@ zero_extendqisi2
  81:../../application/src/fobFirmware.c ****   {
 549              		.loc 1 81 6 view .LVU134
 550 0038 53B9     		cbnz	r3, .L39
  83:../../application/src/fobFirmware.c ****   }
 551              		.loc 1 83 5 is_stmt 1 view .LVU135
 552 003a 20AC     		add	r4, sp, #128
 553 003c 16AD     		add	r5, sp, #88
 554 003e 0FCD     		ldmia	r5!, {r0, r1, r2, r3}
 555 0040 0FC4     		stmia	r4!, {r0, r1, r2, r3}
 556 0042 0FCD     		ldmia	r5!, {r0, r1, r2, r3}
 557 0044 0FC4     		stmia	r4!, {r0, r1, r2, r3}
 558 0046 95E80300 		ldm	r5, {r0, r1}
 559 004a 44F8040B 		str	r0, [r4], #4
 560 004e 2170     		strb	r1, [r4]
 561              	.L39:
  87:../../application/src/fobFirmware.c ****   {
 562              		.loc 1 87 3 view .LVU136
  87:../../application/src/fobFirmware.c ****   {
 563              		.loc 1 87 33 is_stmt 0 view .LVU137
 564 0050 9DF8A130 		ldrb	r3, [sp, #161]	@ zero_extendqisi2
  87:../../application/src/fobFirmware.c ****   {
 565              		.loc 1 87 6 view .LVU138
 566 0054 FF2B     		cmp	r3, #255
 567 0056 69D0     		beq	.L50
 568              	.L40:
  93:../../application/src/fobFirmware.c ****   uart_write(HOST_UART, (uint8_t*)msg2, strlen(msg2));
 569              		.loc 1 93 3 is_stmt 1 view .LVU139
  93:../../application/src/fobFirmware.c ****   uart_write(HOST_UART, (uint8_t*)msg2, strlen(msg2));
 570              		.loc 1 93 8 is_stmt 0 view .LVU140
 571 0058 0AAC     		add	r4, sp, #40
 572 005a 514D     		ldr	r5, .L54+8
 573 005c 0FCD     		ldmia	r5!, {r0, r1, r2, r3}
 574 005e 0FC4     		stmia	r4!, {r0, r1, r2, r3}
 575 0060 0FCD     		ldmia	r5!, {r0, r1, r2, r3}
 576 0062 0FC4     		stmia	r4!, {r0, r1, r2, r3}
 577 0064 95E80300 		ldm	r5, {r0, r1}
 578 0068 44F8040B 		str	r0, [r4], #4
 579 006c 24F8021B 		strh	r1, [r4], #2	@ movhi
 580 0070 090C     		lsrs	r1, r1, #16
 581 0072 2170     		strb	r1, [r4]
  94:../../application/src/fobFirmware.c ****   uart_write(HOST_UART, (uint8_t*)(&fob_state_ram), sizeof(FLASH_DATA));
 582              		.loc 1 94 3 is_stmt 1 view .LVU141
  94:../../application/src/fobFirmware.c ****   uart_write(HOST_UART, (uint8_t*)(&fob_state_ram), sizeof(FLASH_DATA));
 583              		.loc 1 94 41 is_stmt 0 view .LVU142
 584 0074 0AA8     		add	r0, sp, #40
 585 0076 FFF7FEFF 		bl	strlen
 586              	.LVL40:
 587 007a 0246     		mov	r2, r0
ARM GAS  /tmp/ccMdSqK2.s 			page 17


  94:../../application/src/fobFirmware.c ****   uart_write(HOST_UART, (uint8_t*)(&fob_state_ram), sizeof(FLASH_DATA));
 588              		.loc 1 94 3 view .LVU143
 589 007c 0AA9     		add	r1, sp, #40
 590 007e 0020     		movs	r0, #0
 591 0080 FFF7FEFF 		bl	uart_write
 592              	.LVL41:
  95:../../application/src/fobFirmware.c **** 
 593              		.loc 1 95 3 is_stmt 1 view .LVU144
 594 0084 2522     		movs	r2, #37
 595 0086 20A9     		add	r1, sp, #128
 596 0088 0020     		movs	r0, #0
 597 008a FFF7FEFF 		bl	uart_write
 598              	.LVL42:
  98:../../application/src/fobFirmware.c ****   uint8_t uart_buffer_index = 0;
 599              		.loc 1 98 3 view .LVU145
  99:../../application/src/fobFirmware.c **** 
 600              		.loc 1 99 3 view .LVU146
  99:../../application/src/fobFirmware.c **** 
 601              		.loc 1 99 11 is_stmt 0 view .LVU147
 602 008e 0025     		movs	r5, #0
 603              	.LVL43:
 604              	.L41:
 102:../../application/src/fobFirmware.c ****   {
 605              		.loc 1 102 3 is_stmt 1 view .LVU148
 106:../../application/src/fobFirmware.c ****     {
 606              		.loc 1 106 5 view .LVU149
 106:../../application/src/fobFirmware.c ****     {
 607              		.loc 1 106 9 is_stmt 0 view .LVU150
 608 0090 0020     		movs	r0, #0
 609 0092 FFF7FEFF 		bl	uart_avail
 610              	.LVL44:
 106:../../application/src/fobFirmware.c ****     {
 611              		.loc 1 106 8 view .LVU151
 612 0096 0028     		cmp	r0, #0
 613 0098 4FD1     		bne	.L51
 614              	.LVL45:
 615              	.L42:
 132:../../application/src/fobFirmware.c ****     {
 616              		.loc 1 132 5 is_stmt 1 view .LVU152
 132:../../application/src/fobFirmware.c ****     {
 617              		.loc 1 132 8 is_stmt 0 view .LVU153
 618 009a FFF7FEFF 		bl	buttonPressed
 619              	.LVL46:
 132:../../application/src/fobFirmware.c ****     {
 620              		.loc 1 132 7 view .LVU154
 621 009e 0028     		cmp	r0, #0
 622 00a0 F6D0     		beq	.L41
 623              	.LBB7:
 134:../../application/src/fobFirmware.c ****       uart_write(HOST_UART, (uint8_t*)msg, strlen(msg));
 624              		.loc 1 134 7 is_stmt 1 view .LVU155
 134:../../application/src/fobFirmware.c ****       uart_write(HOST_UART, (uint8_t*)msg, strlen(msg));
 625              		.loc 1 134 12 is_stmt 0 view .LVU156
 626 00a2 0DF1040C 		add	ip, sp, #4
 627 00a6 3F4C     		ldr	r4, .L54+12
 628 00a8 0FCC     		ldmia	r4!, {r0, r1, r2, r3}
 629 00aa ACE80F00 		stmia	ip!, {r0, r1, r2, r3}
 630 00ae 94E80300 		ldm	r4, {r0, r1}
ARM GAS  /tmp/ccMdSqK2.s 			page 18


 631 00b2 4CF8040B 		str	r0, [ip], #4
 632 00b6 2CF8021B 		strh	r1, [ip], #2	@ movhi
 633 00ba 090C     		lsrs	r1, r1, #16
 634 00bc 8CF80010 		strb	r1, [ip]
 135:../../application/src/fobFirmware.c ****       unlockCar(&fob_state_ram);
 635              		.loc 1 135 7 is_stmt 1 view .LVU157
 135:../../application/src/fobFirmware.c ****       unlockCar(&fob_state_ram);
 636              		.loc 1 135 44 is_stmt 0 view .LVU158
 637 00c0 01A8     		add	r0, sp, #4
 638 00c2 FFF7FEFF 		bl	strlen
 639              	.LVL47:
 640 00c6 0246     		mov	r2, r0
 135:../../application/src/fobFirmware.c ****       unlockCar(&fob_state_ram);
 641              		.loc 1 135 7 view .LVU159
 642 00c8 01A9     		add	r1, sp, #4
 643 00ca 0020     		movs	r0, #0
 644 00cc FFF7FEFF 		bl	uart_write
 645              	.LVL48:
 136:../../application/src/fobFirmware.c ****       if (receiveAck())
 646              		.loc 1 136 7 is_stmt 1 view .LVU160
 647 00d0 20A8     		add	r0, sp, #128
 648 00d2 FFF7FEFF 		bl	unlockCar
 649              	.LVL49:
 137:../../application/src/fobFirmware.c ****       {
 650              		.loc 1 137 7 view .LVU161
 137:../../application/src/fobFirmware.c ****       {
 651              		.loc 1 137 11 is_stmt 0 view .LVU162
 652 00d6 FFF7FEFF 		bl	receiveAck
 653              	.LVL50:
 137:../../application/src/fobFirmware.c ****       {
 654              		.loc 1 137 10 view .LVU163
 655 00da 0028     		cmp	r0, #0
 656 00dc D8D0     		beq	.L41
 139:../../application/src/fobFirmware.c ****       }
 657              		.loc 1 139 9 is_stmt 1 view .LVU164
 658 00de 20A8     		add	r0, sp, #128
 659 00e0 FFF7FEFF 		bl	startCar
 660              	.LVL51:
 661 00e4 D4E7     		b	.L41
 662              	.LVL52:
 663              	.L49:
 139:../../application/src/fobFirmware.c ****       }
 664              		.loc 1 139 9 is_stmt 0 view .LVU165
 665              	.LBE7:
  66:../../application/src/fobFirmware.c ****     strcpy((char *)(fob_state_ram.pair_info.pin), PAIR_PIN);
 666              		.loc 1 66 5 is_stmt 1 view .LVU166
 667 00e6 304B     		ldr	r3, .L54+16
 668 00e8 1868     		ldr	r0, [r3]
 669 00ea CDF88900 		str	r0, [sp, #137]	@ unaligned
 670 00ee 9A88     		ldrh	r2, [r3, #4]	@ unaligned
 671 00f0 9B79     		ldrb	r3, [r3, #6]	@ zero_extendqisi2
 672 00f2 ADF88D20 		strh	r2, [sp, #141]	@ unaligned
 673 00f6 8DF88F30 		strb	r3, [sp, #143]
  67:../../application/src/fobFirmware.c ****     strcpy((char *)(fob_state_ram.pair_info.car_id), CAR_ID);
 674              		.loc 1 67 5 view .LVU167
 675 00fa 2C4B     		ldr	r3, .L54+20
 676 00fc 1868     		ldr	r0, [r3]
ARM GAS  /tmp/ccMdSqK2.s 			page 19


 677 00fe CDF89100 		str	r0, [sp, #145]	@ unaligned
 678 0102 9A88     		ldrh	r2, [r3, #4]	@ unaligned
 679 0104 9B79     		ldrb	r3, [r3, #6]	@ zero_extendqisi2
 680 0106 ADF89520 		strh	r2, [sp, #149]	@ unaligned
 681 010a 8DF89730 		strb	r3, [sp, #151]
  68:../../application/src/fobFirmware.c ****     strcpy((char *)(fob_state_ram.feature_info.car_id), CAR_ID);
 682              		.loc 1 68 5 view .LVU168
 683 010e 284B     		ldr	r3, .L54+24
 684 0110 1868     		ldr	r0, [r3]
 685 0112 CDF88100 		str	r0, [sp, #129]	@ unaligned
 686 0116 1B79     		ldrb	r3, [r3, #4]	@ zero_extendqisi2
 687 0118 8DF88530 		strb	r3, [sp, #133]
  69:../../application/src/fobFirmware.c ****     fob_state_ram.paired = FLASH_PAIRED;
 688              		.loc 1 69 5 view .LVU169
 689 011c CDF89900 		str	r0, [sp, #153]	@ unaligned
 690 0120 8DF89D30 		strb	r3, [sp, #157]
  70:../../application/src/fobFirmware.c **** 
 691              		.loc 1 70 5 view .LVU170
  70:../../application/src/fobFirmware.c **** 
 692              		.loc 1 70 26 is_stmt 0 view .LVU171
 693 0124 0023     		movs	r3, #0
 694 0126 8DF88030 		strb	r3, [sp, #128]
 695 012a 75E7     		b	.L38
 696              	.L50:
  89:../../application/src/fobFirmware.c ****     saveFobState(&fob_state_ram);
 697              		.loc 1 89 5 is_stmt 1 view .LVU172
  89:../../application/src/fobFirmware.c ****     saveFobState(&fob_state_ram);
 698              		.loc 1 89 43 is_stmt 0 view .LVU173
 699 012c 0023     		movs	r3, #0
 700 012e 8DF8A130 		strb	r3, [sp, #161]
  90:../../application/src/fobFirmware.c ****   }
 701              		.loc 1 90 5 is_stmt 1 view .LVU174
 702 0132 20A8     		add	r0, sp, #128
 703 0134 FFF7FEFF 		bl	saveFobState
 704              	.LVL53:
 705 0138 8EE7     		b	.L40
 706              	.LVL54:
 707              	.L51:
 708              	.LBB8:
 108:../../application/src/fobFirmware.c **** 
 709              		.loc 1 108 7 view .LVU175
 108:../../application/src/fobFirmware.c **** 
 710              		.loc 1 108 36 is_stmt 0 view .LVU176
 711 013a 0020     		movs	r0, #0
 712 013c FFF7FEFF 		bl	uart_readb
 713              	.LVL55:
 108:../../application/src/fobFirmware.c **** 
 714              		.loc 1 108 15 view .LVU177
 715 0140 C0B2     		uxtb	r0, r0
 716              	.LVL56:
 110:../../application/src/fobFirmware.c ****           (uart_char != 0xD))
 717              		.loc 1 110 7 is_stmt 1 view .LVU178
 110:../../application/src/fobFirmware.c ****           (uart_char != 0xD))
 718              		.loc 1 110 10 is_stmt 0 view .LVU179
 719 0142 0D28     		cmp	r0, #13
 720 0144 0AD0     		beq	.L43
 110:../../application/src/fobFirmware.c ****           (uart_char != 0xD))
ARM GAS  /tmp/ccMdSqK2.s 			page 20


 721              		.loc 1 110 31 discriminator 1 view .LVU180
 722 0146 0A28     		cmp	r0, #10
 723 0148 08D0     		beq	.L43
 110:../../application/src/fobFirmware.c ****           (uart_char != 0xD))
 724              		.loc 1 110 54 discriminator 2 view .LVU181
 725 014a 38B1     		cbz	r0, .L43
 113:../../application/src/fobFirmware.c ****         uart_buffer_index++;
 726              		.loc 1 113 9 is_stmt 1 view .LVU182
 113:../../application/src/fobFirmware.c ****         uart_buffer_index++;
 727              		.loc 1 113 40 is_stmt 0 view .LVU183
 728 014c 05F1A803 		add	r3, r5, #168
 729 0150 6B44     		add	r3, sp, r3
 730 0152 03F88C0C 		strb	r0, [r3, #-140]
 114:../../application/src/fobFirmware.c ****       }
 731              		.loc 1 114 9 is_stmt 1 view .LVU184
 114:../../application/src/fobFirmware.c ****       }
 732              		.loc 1 114 26 is_stmt 0 view .LVU185
 733 0156 0135     		adds	r5, r5, #1
 734              	.LVL57:
 114:../../application/src/fobFirmware.c ****       }
 735              		.loc 1 114 26 view .LVU186
 736 0158 EDB2     		uxtb	r5, r5
 737              	.LVL58:
 114:../../application/src/fobFirmware.c ****       }
 738              		.loc 1 114 26 view .LVU187
 739 015a 9EE7     		b	.L42
 740              	.L43:
 118:../../application/src/fobFirmware.c ****         uart_buffer_index = 0;
 741              		.loc 1 118 9 is_stmt 1 view .LVU188
 118:../../application/src/fobFirmware.c ****         uart_buffer_index = 0;
 742              		.loc 1 118 40 is_stmt 0 view .LVU189
 743 015c 05F1A803 		add	r3, r5, #168
 744 0160 0DEB0305 		add	r5, sp, r3
 745              	.LVL59:
 118:../../application/src/fobFirmware.c ****         uart_buffer_index = 0;
 746              		.loc 1 118 40 view .LVU190
 747 0164 0023     		movs	r3, #0
 748 0166 05F88C3C 		strb	r3, [r5, #-140]
 119:../../application/src/fobFirmware.c **** 
 749              		.loc 1 119 9 is_stmt 1 view .LVU191
 750              	.LVL60:
 121:../../application/src/fobFirmware.c ****         {
 751              		.loc 1 121 9 view .LVU192
 121:../../application/src/fobFirmware.c ****         {
 752              		.loc 1 121 15 is_stmt 0 view .LVU193
 753 016a 1249     		ldr	r1, .L54+28
 754 016c 07A8     		add	r0, sp, #28
 755              	.LVL61:
 121:../../application/src/fobFirmware.c ****         {
 756              		.loc 1 121 15 view .LVU194
 757 016e FFF7FEFF 		bl	strcmp
 758              	.LVL62:
 121:../../application/src/fobFirmware.c ****         {
 759              		.loc 1 121 12 view .LVU195
 760 0172 30B1     		cbz	r0, .L52
 125:../../application/src/fobFirmware.c ****         {
 761              		.loc 1 125 14 is_stmt 1 view .LVU196
ARM GAS  /tmp/ccMdSqK2.s 			page 21


 125:../../application/src/fobFirmware.c ****         {
 762              		.loc 1 125 20 is_stmt 0 view .LVU197
 763 0174 1049     		ldr	r1, .L54+32
 764 0176 07A8     		add	r0, sp, #28
 765 0178 FFF7FEFF 		bl	strcmp
 766              	.LVL63:
 125:../../application/src/fobFirmware.c ****         {
 767              		.loc 1 125 17 view .LVU198
 768 017c 30B1     		cbz	r0, .L53
 119:../../application/src/fobFirmware.c **** 
 769              		.loc 1 119 27 view .LVU199
 770 017e 0025     		movs	r5, #0
 771 0180 8BE7     		b	.L42
 772              	.L52:
 123:../../application/src/fobFirmware.c ****         }
 773              		.loc 1 123 11 is_stmt 1 view .LVU200
 774 0182 20A8     		add	r0, sp, #128
 775 0184 FFF7FEFF 		bl	enableFeature
 776              	.LVL64:
 119:../../application/src/fobFirmware.c **** 
 777              		.loc 1 119 27 is_stmt 0 view .LVU201
 778 0188 0025     		movs	r5, #0
 779 018a 86E7     		b	.L42
 780              	.L53:
 127:../../application/src/fobFirmware.c ****         }
 781              		.loc 1 127 11 is_stmt 1 view .LVU202
 782 018c 20A8     		add	r0, sp, #128
 783 018e FFF7FEFF 		bl	pairFob
 784              	.LVL65:
 119:../../application/src/fobFirmware.c **** 
 785              		.loc 1 119 27 is_stmt 0 view .LVU203
 786 0192 0025     		movs	r5, #0
 787 0194 81E7     		b	.L42
 788              	.L55:
 789 0196 00BF     		.align	2
 790              	.L54:
 791 0198 00000000 		.word	.LC3
 792 019c 34000000 		.word	.LC7
 793 01a0 3C000000 		.word	.LC8
 794 01a4 64000000 		.word	.LC11
 795 01a8 0C000000 		.word	.LC4
 796 01ac 14000000 		.word	.LC5
 797 01b0 1C000000 		.word	.LC6
 798 01b4 24000000 		.word	.LC9
 799 01b8 2C000000 		.word	.LC10
 800              	.LBE8:
 801              		.cfi_endproc
 802              	.LFE0:
 804              		.text
 805              	.Letext0:
 806              		.file 2 "/usr/lib/gcc/arm-none-eabi/10.3.1/include/stdint.h"
 807              		.file 3 "../../application/inc/messages.h"
 808              		.file 4 "../../application/inc/dataFormats.h"
 809              		.file 5 "../../application/inc/uart.h"
 810              		.file 6 "/usr/include/newlib/string.h"
 811              		.file 7 "../../application/inc/platform.h"
ARM GAS  /tmp/ccMdSqK2.s 			page 22


DEFINED SYMBOLS
                            *ABS*:0000000000000000 fobFirmware.c
     /tmp/ccMdSqK2.s:18     .rodata.pairFob.str1.4:0000000000000000 $d
     /tmp/ccMdSqK2.s:25     .text.pairFob:0000000000000000 $t
     /tmp/ccMdSqK2.s:33     .text.pairFob:0000000000000000 pairFob
     /tmp/ccMdSqK2.s:157    .text.pairFob:0000000000000074 $d
     /tmp/ccMdSqK2.s:163    .rodata.enableFeature.str1.4:0000000000000000 $d
     /tmp/ccMdSqK2.s:167    .text.enableFeature:0000000000000000 $t
     /tmp/ccMdSqK2.s:174    .text.enableFeature:0000000000000000 enableFeature
     /tmp/ccMdSqK2.s:286    .text.enableFeature:0000000000000064 $d
     /tmp/ccMdSqK2.s:291    .text.unlockCar:0000000000000000 $t
     /tmp/ccMdSqK2.s:298    .text.unlockCar:0000000000000000 unlockCar
     /tmp/ccMdSqK2.s:354    .text.startCar:0000000000000000 $t
     /tmp/ccMdSqK2.s:361    .text.startCar:0000000000000000 startCar
     /tmp/ccMdSqK2.s:417    .text.receiveAck:0000000000000000 $t
     /tmp/ccMdSqK2.s:424    .text.receiveAck:0000000000000000 receiveAck
     /tmp/ccMdSqK2.s:460    .rodata.main.str1.4:0000000000000000 $d
     /tmp/ccMdSqK2.s:488    .text.main:0000000000000000 $t
     /tmp/ccMdSqK2.s:495    .text.main:0000000000000000 main
     /tmp/ccMdSqK2.s:791    .text.main:0000000000000198 $d

UNDEFINED SYMBOLS
uart_write
uart_readline
strcmp
send_board_message
receive_board_message_by_type
strcpy
saveFobState
initHardware_fob
readVar
strlen
uart_avail
buttonPressed
uart_readb
